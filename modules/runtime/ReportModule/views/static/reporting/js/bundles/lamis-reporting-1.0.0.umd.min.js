!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("@lamis/web-core"),require("moment"),require("@stomp/ng2-stompjs"),require("@angular/platform-browser"),require("file-saver"),require("@angular/common"),require("@angular/material"),require("@angular/router"),require("@angular/forms"),require("@syncfusion/ej2-angular-dropdowns"),require("@syncfusion/ej2-angular-calendars")):"function"==typeof define&&define.amd?define("lamis-reporting-1.0.0",["exports","@angular/core","@angular/common/http","@lamis/web-core","moment","@stomp/ng2-stompjs","@angular/platform-browser","file-saver","@angular/common","@angular/material","@angular/router","@angular/forms","@syncfusion/ej2-angular-dropdowns","@syncfusion/ej2-angular-calendars"],e):e(((t=t||self)["lamis-reporting-1"]=t["lamis-reporting-1"]||{},t["lamis-reporting-1"][0]=t["lamis-reporting-1"][0]||{},t["lamis-reporting-1"][0][0]={}),t.ng.core,t.ng.common.http,t.webCore,t.moment_,t.ng2Stompjs,t.ng.platformBrowser,t.fileSaver,t.ng.common,t.ng.material,t.ng.router,t.ng.forms,t.ej2AngularDropdowns,t.ej2AngularCalendars)}(this,(function(t,e,n,a,i,r,o,l,s,d,m,c,p,u){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function f(t,e,n,a){var i,r=arguments.length,o=r<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,a);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(o=(r<3?i(o):r>3?i(e,n,o):i(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o}function g(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var v=i,h=function(){function t(t,e){this.http=t,this.serverUrl=e,this.resourceUrl="",this.resourceUrl=e.SERVER_API_URL+"/api/reporting"}var i,r;return t.prototype.artSummary=function(t,e,i){var r=new n.HttpParams;return r=(r=(r=r.append("reportingPeriod",v(t).format(a.DATE_FORMAT))).append("id",e.toString())).append("today",i.toString()),this.http.get(this.resourceUrl+"/art-summary",{params:r,responseType:"blob"})},t.prototype.patientLineList=function(t){return t.dateCurrentStatusBegin=null!=t.dateCurrentStatusBegin&&t.dateCurrentStatusBegin.isValid()?t.dateCurrentStatusBegin.format(a.DATE_FORMAT):null,t.dateCurrentStatusEnd=null!=t.dateCurrentStatusEnd&&t.dateCurrentStatusEnd.isValid()?t.dateCurrentStatusEnd.format(a.DATE_FORMAT):null,t.dateLastViralLoadBegin=null!=t.dateLastViralLoadBegin&&t.dateLastViralLoadBegin.isValid()?t.dateLastViralLoadBegin.format(a.DATE_FORMAT):null,t.dateLastViralLoadEnd=null!=t.dateLastViralLoadEnd&&t.dateLastViralLoadEnd.isValid()?t.dateLastViralLoadEnd.format(a.DATE_FORMAT):null,t.dateRegistrationBegin=null!=t.dateRegistrationBegin&&t.dateRegistrationBegin.isValid()?t.dateRegistrationBegin.format(a.DATE_FORMAT):null,t.dateRegistrationEnd=null!=t.dateRegistrationEnd&&t.dateRegistrationEnd.isValid()?t.dateRegistrationEnd.format(a.DATE_FORMAT):null,t.dateStartBegin=null!=t.dateStartBegin&&t.dateStartBegin.isValid()?t.dateStartBegin.format(a.DATE_FORMAT):null,t.dateStartEnd=null!=t.dateStartEnd&&t.dateStartEnd.isValid()?t.dateStartEnd.format(a.DATE_FORMAT):null,this.http.post(this.resourceUrl+"/patient-line-list",t,{responseType:"blob"})},t.prototype.getRegimenTypes=function(){return this.http.get(this.resourceUrl+"/regimen-types")},t.prototype.getStates=function(){return this.http.get("/api/states")},t.prototype.getLgasByState=function(t){return this.http.get("/api/provinces/state/"+t)},t.prototype.getActiveFacility=function(){return this.http.get("/api/facilities/active")},t.prototype.listFacilities=function(){return this.http.get(this.resourceUrl+"/list-facilities")},t.prototype.download=function(t){return this.http.get(this.resourceUrl+"/download/"+t,{responseType:"blob"})},t.prototype.listFiles=function(){return this.http.get(this.resourceUrl+"/list-files")},t.ctorParameters=function(){return[{type:n.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[a.SERVER_API_URL_CONFIG]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(a.SERVER_API_URL_CONFIG))},token:t,providedIn:"root"}),t=f([e.Injectable({providedIn:"root"}),(i=1,r=e.Inject(a.SERVER_API_URL_CONFIG),function(t,e){r(t,e,i)}),g("design:paramtypes",[n.HttpClient,Object])],t)}(),b=function(){function t(t,e,n){this.service=t,this.stompService=e,this.domSanitizer=n,this.running=!1,this.message="Running",this.finished=!1,this.reportingPeriod=new Date,this.today=new Date,this.todaySelectable=!0,this.current=!1}return t.prototype.ngOnInit=function(){var t=this;this.service.getActiveFacility().subscribe((function(e){return t.facility=e})),this.topicSubscription=this.stompService.watch("/topic/art-summary/status").subscribe((function(e){"start"===e.body?t.running=!0:"end"===e.body?(t.running=!1,t.finished=!0,t.message="Finished",t.service.listFiles().subscribe((function(e){t.files=e}))):(t.message=e.body,t.running=!0)}))},t.prototype.download=function(t){this.service.download(t).subscribe((function(e){var n=new File([e],t+"ART Summary Report.pdf",{type:"application/octet-stream"});l.saveAs(n)}))},t.prototype.tabChanged=function(t){var e=this;1===t.index&&this.service.listFiles().subscribe((function(t){e.files=t}))},t.prototype.monthChanged=function(t){this.todaySelectable=(new Date).getMonth()===t.getMonth()},t.prototype.convert=function(){var t=this;this.running=!0,this.finished=!1,this.service.artSummary(this.reportingPeriod,this.facility.id,this.current).subscribe((function(e){var n=new File([e],t.facility.name+"_ART Summary Report.pdf",{type:"application/octet-stream"});l.saveAs(n)}))},t.prototype.ngOnDestroy=function(){this.topicSubscription.unsubscribe()},t.ctorParameters=function(){return[{type:h},{type:r.RxStompService},{type:o.DomSanitizer}]},t=f([e.Component({selector:"art-summary",template:'<mat-card>\r\n    <mat-card-header class="full-width">\r\n        <ng-container *ngIf="running">\r\n            <div class="full-width">\r\n                <mat-progress-bar class="full-width" mode="indeterminate"></mat-progress-bar>\r\n                <mat-form-field class="full-width">\r\n                    <input [disabled]="true" matInput [value]="message"/>\r\n                </mat-form-field>\r\n            </div>\r\n        </ng-container>\r\n        <ng-container *ngIf="finished">\r\n            <div class="full-width">\r\n                <mat-form-field class="full-width">\r\n                    <input [disabled]="true" matInput [value]="message"/>\r\n                </mat-form-field>\r\n            </div>\r\n        </ng-container>\r\n    </mat-card-header>\r\n    <mat-card-content>\r\n        <div class="row">\r\n            <div class="col-md-12">\r\n                Facility:&nbsp;&nbsp;{{facility?.name}}\r\n            </div>\r\n        </div>\r\n        <div class="row">\r\n            <div class="col-md-6">\r\n                <ejs-datepicker placeholder="Select Reporting period" [start]="\'Year\'"\r\n                                [format]="\'MMMM y\'"\r\n                                (valueChangeh)="monthChanged($event)"\r\n                                [(value)]="reportingPeriod"\r\n                                [depth]="\'Year\'">\r\n                </ejs-datepicker>\r\n            </div>\r\n            <div class="col-md-6">\r\n                <mat-checkbox [(ngModel)]="current" name="today" *ngIf="todaySelectable">As at today</mat-checkbox>\r\n            </div>\r\n        </div>\r\n        <mat-card-actions>\r\n            <button mat-raised-button color="primary"\r\n                    (click)="convert()"\r\n                    [disabled]="running || !reportingPeriod || !facility">Generate Report\r\n            </button>\r\n        </mat-card-actions>\r\n    </mat-card-content>\r\n</mat-card>\r\n\r\n'}),g("design:paramtypes",[h,r.RxStompService,o.DomSanitizer])],t)}(),y=i,S=function(){function t(t,e){this.service=t,this.stompService=e,this.params={},this.running=!1,this.finished=!1,this.today=y(),this.message="Running"}return t.prototype.ngOnInit=function(){var t=this;this.service.getActiveFacility().subscribe((function(e){t.facility=e,t.params.facilityId=t.facility.id})),this.topicSubscription=this.stompService.watch("/topic/patient-line-list/status").subscribe((function(e){"start"===e.body?(t.running=!0,t.finished=!1,t.message="Running"):"end"===e.body?(t.running=!1,t.finished=!0,t.message="Finished"):(t.message=e.body,t.running=!0)})),this.service.getStates().subscribe((function(e){return t.states=e})),this.service.getRegimenTypes().subscribe((function(e){return t.regimenTypes=e}))},t.prototype.stateChanged=function(t){var e=this;t&&t.id&&this.service.getLgasByState(t.id).subscribe((function(t){return e.lgas=t}))},t.prototype.convert=function(){var t=this;this.running=!0,this.service.patientLineList(this.params).subscribe((function(e){var n=new File([e],t.facility.name+"_Patient_Line_List.pdf",{type:"application/octet-stream"});l.saveAs(n)}))},t.prototype.ngOnDestroy=function(){this.topicSubscription.unsubscribe()},t.ctorParameters=function(){return[{type:h},{type:r.RxStompService}]},t=f([e.Component({selector:"report-patient-line-list",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <form name="form" role="form" novalidate (ngSubmit)="convert()" #plForm="ngForm">\n            <mat-card class="default">\n                <mat-card-header>\n                    Patient Information Query\n                </mat-card-header>\n                <mat-card-content>\n                    <ng-container *ngIf="running">\n                        <div class="full-width">\n                            <mat-progress-bar class="full-width" mode="indeterminate"></mat-progress-bar>\n                            <mat-form-field class="full-width">\n                                <input [disabled]="true" matInput [value]="message"/>\n                            </mat-form-field>\n                        </div>\n                    </ng-container>\n                    <ng-container *ngIf="finished">\n                        <div class="full-width">\n                            <mat-form-field class="full-width">\n                                <input [disabled]="true" matInput [value]="message"/>\n                            </mat-form-field>\n                        </div>\n                    </ng-container>\n                    <fieldset>\n                        <h5>Demographic filters</h5>\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>Gender</mat-label>\n                                    <mat-select name="gender" [(ngModel)]="params.gender">\n                                        <mat-option></mat-option>\n                                        <mat-option value="MALE">Male</mat-option>\n                                        <mat-option value="FEMALE">Female</mat-option>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-12">\n                                <h5>Age Range</h5>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>From</mat-label>\n                                    <input matInput name="ageBegin" type="number" [(ngModel)]="params.ageBegin"/>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>To</mat-label>\n                                    <input matInput name="ageEnd" type="number" [(ngModel)]="params.ageEnd"/>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>State</mat-label>\n                                    <mat-select (valueChange)="stateChanged($event)">\n                                        <mat-option></mat-option>\n                                        <mat-option *ngFor="let state of states"\n                                                    [value]="state">{{state.name}}</mat-option>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>LGA of residence</mat-label>\n                                    <mat-select name="lga" [(ngModel)]="params.lgaId">\n                                        <mat-option></mat-option>\n                                        <mat-option *ngFor="let lga of lgas" [value]="lga.id">{{lga.name}}</mat-option>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                    </fieldset>\n                    <fieldset>\n                        <h5>Clinical filters</h5>\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>Current Status</mat-label>\n                                    <mat-select name="currentStatus" [(ngModel)]="params.currentStatus">\n                                        <mat-option></mat-option>\n                                        <mat-option value="HIV_PLUS_NON_ART">HIV+ non ART</mat-option>\n                                        <mat-option value="ART_START">ART Start</mat-option>\n                                        <mat-option value="ART_RESTART">ART Restart</mat-option>\n                                        <mat-option value="ART_TRANSFER_IN">ART Transfer In</mat-option>\n                                        <mat-option value="ART_TRANSFER_OUT">ART Transfer Out</mat-option>\n                                        <mat-option value="PRE_ART_TRANSFER_IN">Pre-ART Transfer In</mat-option>\n                                        <mat-option value="PRE_ART_TRANSFER_OUT">Pre-ART Transfer Out</mat-option>\n                                        <mat-option value="LOST_TO_FOLLOWUP">Lost to Follow Up</mat-option>\n                                        <mat-option value="STOPPED_TREATMENT">Stopped Treatment</mat-option>\n                                        <mat-option value="KNOWN_DEATH">Known Death</mat-option>\n                                        <mat-option value="Currently Active">Currently Active</mat-option>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-12">\n                                <h5>Date of Current Status</h5>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>From</mat-label>\n                                    <input matInput [matDatepicker]="picker1"\n                                           [max]="today"\n                                           [(ngModel)]="params.dateCurrentStatusBegin"\n                                           name="date1">\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker1">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker1></mat-datepicker>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>To</mat-label>\n                                    <input matInput [matDatepicker]="picker2"\n                                           [(ngModel)]="params.dateCurrentStatusEnd"\n                                           [max]="today"\n                                           name="date2">\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker2">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker2></mat-datepicker>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>Regimen Line</mat-label>\n                                    <mat-select name="regimenType" [(ngModel)]="params.regimenType">\n                                        <mat-option></mat-option>\n                                        <mat-option *ngFor="let type of regimenTypes"\n                                                    [value]="type.description">{{type.description}}</mat-option>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-12">\n                                <h5>Date of Registration</h5>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>From</mat-label>\n                                    <input matInput [matDatepicker]="picker3"\n                                           [max]="today"\n                                           [(ngModel)]="params.dateRegistrationBegin"\n                                           name="date3">\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker3">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker3></mat-datepicker>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>To</mat-label>\n                                    <input matInput [matDatepicker]="picker4"\n                                           [max]="today"\n                                           [(ngModel)]="params.dateRegistrationEnd"\n                                           name="date4">\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker4">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker4></mat-datepicker>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-12">\n                                <h5>ART Start Date</h5>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>From</mat-label>\n                                    <input matInput [matDatepicker]="picker5"\n                                           [max]="today"\n                                           [(ngModel)]="params.dateStartBegin"\n                                           name="date5">\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker5">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker5></mat-datepicker>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>To</mat-label>\n                                    <input matInput [matDatepicker]="picker6"\n                                           [max]="today"\n                                           [(ngModel)]="params.dateStartEnd"\n                                           name="date6">\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker6">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker6></mat-datepicker>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-label>Current Clinical Stage</mat-label>\n                                    <mat-select name="clinicStage" [(ngModel)]="params.clinicStage">\n                                        <mat-option></mat-option>\n                                        <mat-option value="Stage I">Stage I</mat-option>\n                                        <mat-option value="Stage II">Stage II</mat-option>\n                                        <mat-option value="Stage III">Stage III</mat-option>\n                                        <mat-option value="Stage IV">Stage IV</mat-option>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <fieldset>\n                            <h5>Viral Load</h5>\n                            <div class="row">\n                                <div class="col-md-12">\n                                    <h5>Last Viral Load</h5>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>From</mat-label>\n                                        <input matInput name="viralLoadBegin" type="number"\n                                               [(ngModel)]="params.viralLoadBegin"/>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>To</mat-label>\n                                        <input matInput name="viralLoadEnd" type="number"\n                                               [(ngModel)]="params.viralLoadEnd"/>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-12">\n                                    <h5>Date of Last Viral Load</h5>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>From</mat-label>\n                                        <input matInput [matDatepicker]="picker7"\n                                               [max]="today"\n                                               [(ngModel)]="params.dateLastViralLoadBegin"\n                                               name="date7">\n                                        <mat-datepicker-toggle\n                                                matSuffix\n                                                [for]="picker7">\n                                        </mat-datepicker-toggle>\n                                        <mat-datepicker #picker7></mat-datepicker>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>To</mat-label>\n                                        <input matInput [matDatepicker]="picker8"\n                                               [max]="today"\n                                               [(ngModel)]="params.dateLastViralLoadEnd"\n                                               name="date8">\n                                        <mat-datepicker-toggle\n                                                matSuffix\n                                                [for]="picker8">\n                                        </mat-datepicker-toggle>\n                                        <mat-datepicker #picker8></mat-datepicker>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                        </fieldset>\n                    </fieldset>\n                    <mat-card-actions>\n                        <button mat-raised-button color="primary"\n                                [disabled]="running || !facility">Generate Report\n                        </button>\n                    </mat-card-actions>\n                </mat-card-content>\n            </mat-card>\n        </form>\n    </div>\n</div>\n'}),g("design:paramtypes",[h,r.RxStompService])],t)}(),R={title:"Reports",breadcrumb:"REPORTS"},T={breadcrumb:"ART SUMMARY REPORT",title:"ART Summary Report"},k={breadcrumb:"PATIENT LINE LIST",title:"Patient Line List"},M={breadcrumb:"PATIENT REPORTs",title:"Patient Reports"},w=[{path:"",data:R,children:[{path:"art-summary",component:b,data:T},{path:"patients",children:[{path:"line-list",component:S,data:k}],data:M}]}],A=function(){function t(){}return t=f([e.NgModule({declarations:[b,S],imports:[s.CommonModule,c.FormsModule,d.MatInputModule,d.MatIconModule,d.MatDividerModule,d.MatCardModule,d.MatSelectModule,d.MatButtonModule,d.MatTabsModule,d.MatDatepickerModule,m.RouterModule.forChild(w),d.MatProgressBarModule,d.MatListModule,d.MatCheckboxModule,u.DateRangePickerModule,p.DropDownListModule,u.DatePickerModule,a.MatDateFormatModule],exports:[b,S],providers:[]})],t)}();t.ArtSummaryComponent=b,t.ROUTES=w,t.ReportService=h,t.ReportsModule=A,t.ɵ0=R,t.ɵ1=T,t.ɵ2=k,t.ɵ3=M,t.ɵa=S,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=lamis-reporting-1.0.0.umd.min.js.map
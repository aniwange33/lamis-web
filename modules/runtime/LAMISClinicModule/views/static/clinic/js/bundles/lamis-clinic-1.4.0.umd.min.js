!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("@lamis/web-core"),require("rxjs/operators"),require("moment"),require("@alfresco/adf-core"),require("@angular/common"),require("@angular/material"),require("@angular/router"),require("@covalent/core"),require("@swimlane/ngx-datatable"),require("rxjs"),require("@mat-datetimepicker/core"),require("@angular/forms"),require("ng2-validation"),require("@stomp/ng2-stompjs"),require("@ng-bootstrap/ng-bootstrap")):"function"==typeof define&&define.amd?define("lamis-clinic-1.4.0",["exports","@angular/core","@angular/common/http","@lamis/web-core","rxjs/operators","moment","@alfresco/adf-core","@angular/common","@angular/material","@angular/router","@covalent/core","@swimlane/ngx-datatable","rxjs","@mat-datetimepicker/core","@angular/forms","ng2-validation","@stomp/ng2-stompjs","@ng-bootstrap/ng-bootstrap"],e):e(((t=t||self)["lamis-clinic-1"]=t["lamis-clinic-1"]||{},t["lamis-clinic-1"][4]=t["lamis-clinic-1"][4]||{},t["lamis-clinic-1"][4][0]={}),t.ng.core,t.ng.common.http,t.webCore,t.rxjs.operators,t.moment_,t.adfCore,t.ng.common,t.ng.material,t.ng.router,t.core$1,t.ngxDatatable,t.rxjs,t.core$2,t.ng.forms,t.ng2Validation,t.ng2Stompjs,t.ngBootstrap)}(this,(function(t,e,n,i,a,r,o,s,d,l,c,m,p,u,h,f,v,y){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function g(t,e,n,i){var a,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,n,o):a(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o}function b(t,e){return function(n,i){e(n,i,t)}}function M(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function S(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,a,r=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(t){a={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return o}function I(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(S(arguments[e]));return t}var C=r,w=function(){function t(t,e){this.http=t,this.serverUrl=e,this.resourceUrl="",this.resourceUrl=e.SERVER_API_URL+"/api/clinics"}return t.prototype.create=function(t){var e=this;return t=this.convertDateFromClient(t),this.http.post(this.resourceUrl,t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.update=function(t){var e=this;return t=this.convertDateFromClient(t),this.http.put(this.resourceUrl,t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.find=function(t){var e=this;return this.http.get(this.resourceUrl+"/"+t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.findByUuid=function(t){var e=this;return this.http.get(this.resourceUrl+"/by-uuid/"+t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.delete=function(t){return this.http.delete(this.resourceUrl+"/"+t,{observe:"response"})},t.prototype.getVisitDatesByPatient=function(t){return this.http.get(this.resourceUrl+"/patient/"+t+"/visit-dates").pipe(a.map((function(t){return t.forEach((function(t){return C(t)})),t})))},t.prototype.getPatient=function(t){return this.http.get("/api/patients/by-uuid/"+t,{observe:"body"}).pipe(a.map((function(t){return t&&(t.dateRegistration=null!=t.dateRegistration?C(t.dateRegistration):null,t.dateBirth=null!=t.dateBirth?C(t.dateBirth):null),t})))},t.prototype.getRegimenLines=function(){return this.http.get(this.resourceUrl+"/regimen-types")},t.prototype.getRegimenByLine=function(t){return this.http.get(this.resourceUrl+"/regimens/regimen-type/"+t)},t.prototype.adverseDrugReactions=function(){return this.http.get(this.resourceUrl+"/adverse-drug-reactions")},t.prototype.opportunisticInfections=function(){return this.http.get(this.resourceUrl+"/opportunistic-infections")},t.prototype.adheres=function(){return this.http.get(this.resourceUrl+"/adheres")},t.prototype.regimes=function(t){return this.http.get(this.resourceUrl+"/regimens/"+t)},t.prototype.latestVisit=function(t){return this.http.get(this.resourceUrl+"/patient/"+t+"/latest")},t.prototype.enrolledOnOTZ=function(t){return this.http.get(this.resourceUrl+"/patient/"+t+"/enrolled-on-otz")},t.prototype.convertDateFromClient=function(t){return Object.assign({},t,{dateVisit:null!=t.dateVisit&&t.dateVisit.isValid()?t.dateVisit.format(i.DATE_FORMAT):null,lmp:null!=t.lmp&&t.lmp.isValid()?t.lmp.format(i.DATE_FORMAT):null,nextAppointment:null!=t.nextAppointment&&t.nextAppointment.isValid()?t.nextAppointment.format(i.DATE_FORMAT):null,pregnant:null!=t.pregnancyStatus&&2===t.pregnancyStatus,breastfeeding:null!=t.pregnancyStatus&&3===t.pregnancyStatus,bp:t.bp1>0&&t.bp2>0?t.bp1+"/"+t.bp2:null})},t.prototype.convertDateFromServer=function(t){if(t.body&&(t.body.nextAppointment=null!=t.body.nextAppointment?C(t.body.nextAppointment):null,t.body.dateVisit=null!=t.body.dateVisit?C(t.body.dateVisit):null,t.body.lmp=null!=t.body.lmp?C(t.body.lmp):null,t.body.pregnancyStatus=t.body.pregnant?2:t.body.breastfeeding?3:1,t.body.bp)){var e=t.body.bp.split("/");t.body.bp1=parseInt(e[0],10),t.body.bp2=2===e.length?parseInt(e[1],10):null}return t},t.prototype.convertDateArrayFromServer=function(t){return t.body&&t.body.forEach((function(t){t.dateVisit=null!=t.dateVisit?C(t.dateVisit):null,t.lmp=null!=t.lmp?C(t.lmp):null,t.nextAppointment=null!=t.nextAppointment?C(t.nextAppointment):null,t.pregnancyStatus=t.pregnant?2:t.breastfeeding?3:1})),t},t.ctorParameters=function(){return[{type:n.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[i.SERVER_API_URL_CONFIG]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(i.SERVER_API_URL_CONFIG))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"}),b(1,e.Inject(i.SERVER_API_URL_CONFIG)),M("design:paramtypes",[n.HttpClient,Object])],t)}(),k=r,E=function(){function t(t,e,n,i,a,r){this.router=t,this.route=e,this.clinicService=n,this.cfr=i,this._dialogService=a,this.notificationService=r,this.properties=[]}return t.prototype.ngOnInit=function(){var t=this;this.route.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body:n;var i=t.route.snapshot.paramMap.get("patientId");t.clinicService.getPatient(i).subscribe((function(e){return t.entity.patient=e})),t.buildProperties()}))},t.prototype.edit=function(){this.router.navigate(["/","clinics",this.entity.uuid,"patient",this.entity.patient.uuid,"edit"])},t.prototype.delete=function(){var t=this;this._dialogService.openConfirm({title:"Confirm",message:"Do you want to delete this clinic visit, action cannot be reversed?",cancelButton:"No",acceptButton:"Yes",width:"500px"}).afterClosed().subscribe((function(e){e&&t.clinicService.delete(t.entity.id).subscribe((function(e){e.ok?t.router.navigate(["patients"]):t.notificationService.showError("Error deleting visit, please try again")}))}))},t.prototype.buildProperties=function(){this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.entity.dateVisit,label:this.entity.commence?"ART Start Date":"Date Visit",format:"dd MMM, yyyy"})),this.entity.commence&&(this.properties.push(new o.CardViewIntItemModel({label:"CD4 at start of ART",key:"cd4",value:this.entity.cd4p||null})),this.properties.push(new o.CardViewFloatItemModel({label:"CD4%",key:"cd4p",value:this.entity.cd4p||null})),this.properties.push(new o.CardViewTextItemModel({label:"Original Regimen Line",key:"rl",value:null!=this.entity.regimenType?this.entity.regimenType.description:""})),this.properties.push(new o.CardViewTextItemModel({label:"Original Regimen",key:"rl",value:null!=this.entity.regimen?this.entity.regimen.description:""}))),this.entity.extra&&this.entity.patient.extra.prep&&this.entity.patient.extra.prep.registered&&(this.entity.commence?(this.properties.push(new o.CardViewTextItemModel({label:"HIV Status at PrEP Initiation",key:"cs",value:this.entity.extra.prep.hivTestResult})),this.properties.push(new o.CardViewTextItemModel({label:"Creatinine Clearance (mL/min)",key:"cs",value:this.entity.extra.prep.creatinineClearance})),this.properties.push(new o.CardViewTextItemModel({label:"Urinalysis",key:"cs",value:this.entity.extra.prep.urinalysis})),this.properties.push(new o.CardViewTextItemModel({label:"Hepatitis B Screening",key:"cs",value:this.entity.extra.prep.hepatitisB})),this.properties.push(new o.CardViewTextItemModel({label:"Hepatitis C Screening",key:"cs",value:this.entity.extra.prep.hepatitisC}))):this.properties.push(new o.CardViewTextItemModel({label:"HIV Status /Test Result",key:"cs",value:this.entity.extra.prep.hivTestResult}))),this.entity.extra&&this.entity.extra.otz&&this.entity.extra.otz.dateEnrolledOnOTZ&&this.properties.push(new o.CardViewDateItemModel({key:"ds",value:k(this.entity.extra.dateEnrolledOnOTZ),label:"Date Enrolled on OTZ",format:"dd MMM, yyyy"})),this.properties.push(new o.CardViewTextItemModel({label:"Clinical Stage",key:"cs",value:this.entity.clinicStage})),this.properties.push(new o.CardViewTextItemModel({label:"Functional Status",key:"fs",value:this.entity.funcStatus})),this.properties.push(new o.CardViewTextItemModel({label:"TB Status",key:"ts",value:this.entity.tbStatus})),this.properties.push(new o.CardViewFloatItemModel({label:"Body Weight(Kg)",key:"bw",value:this.entity.bodyWeight||null})),this.properties.push(new o.CardViewFloatItemModel({label:"Height(m)",key:"h",value:this.entity.height||null})),this.properties.push(new o.CardViewTextItemModel({label:"Blood Pressure",key:"cd4p",value:this.entity.bp})),"Female"===this.entity.patient.gender&&(this.properties.push(new o.CardViewBoolItemModel({label:"Pregnant",key:"pg",value:this.entity.pregnant})),this.properties.push(new o.CardViewBoolItemModel({label:"Breastfeeding",key:"bf",value:this.entity.breastfeeding})),this.properties.push(new o.CardViewDateItemModel({key:"lpm",value:this.entity.lmp,label:"LMP",format:"dd MMM, yyyy"}))),this.properties.push(new o.CardViewTextItemModel({label:"Level of Adherence",key:"ts",value:this.entity.tbStatus})),this.entity.extra&&this.entity.extra.otz&&this.entity.extra.otz.dateLastOTZMeeting&&this.properties.push(new o.CardViewDateItemModel({key:"ds",value:k(this.entity.extra.dateLastOTZMeeting),label:"Date of Last OTZ Meeting",format:"dd MMM, yyyy"})),this.properties.push(new o.CardViewDateItemModel({key:"na",value:this.entity.nextAppointment,label:"Next Appointment Date",format:"dd MMM, yyyy"}))},t.prototype.previousState=function(){window.history.back()},t.prototype.ngOnDestroy=function(){},t.ctorParameters=function(){return[{type:l.Router},{type:l.ActivatedRoute},{type:w},{type:e.ComponentFactoryResolver},{type:c.TdDialogService},{type:o.NotificationService}]},t=g([e.Component({selector:"lamis-clinic",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <mat-card>\n            <mat-card-header>\n            </mat-card-header>\n            <mat-card-content>\n                <adf-card-view [properties]="properties" editable="false"></adf-card-view>\n            </mat-card-content>\n            <mat-card-actions class="lamis-edit-form-actions">\n                <button mat-button (click)="previousState()">Back</button>\n                <button mat-raised-button color="warn" (click)="delete()">Delete</button>\n                <button mat-raised-button color="primary" (click)="edit()">Edit</button>\n            </mat-card-actions>\n        </mat-card>\n    </div>\n</div>\n'}),M("design:paramtypes",[l.Router,l.ActivatedRoute,w,e.ComponentFactoryResolver,c.TdDialogService,o.NotificationService])],t)}(),R=r,x=function(){function t(t,e,n,i){this.clinicService=t,this.notification=e,this.activatedRoute=n,this.appLoaderService=i,this.error=!1,this.today=R(),this.visitDates=[],this.selectedClinicAdr=[],this.oiList=[],this.adhereList=[],this.ColumnMode=m.ColumnMode,this.adr=!1,this.otzApplicable=!1,this.hasOtz=!1}return t.prototype.createEntity=function(){return{}},t.prototype.ngOnInit=function(){var t=this;this.clinicService.opportunisticInfections().subscribe((function(e){return t.opportunisticInfections=e})),this.clinicService.adheres().subscribe((function(e){return t.adheres=e})),this.isSaving=!1,this.clinicService.getRegimenLines().subscribe((function(e){t.regimenLines=e})),this.activatedRoute.data.subscribe((function(e){var n=e.entity;t.commence=!!t.activatedRoute.snapshot.data.commence,t.entity=n&&n.body?n.body:n,void 0===t.entity&&(t.entity=t.createEntity());var i=t.activatedRoute.snapshot.paramMap.get("patientId");t.clinicService.getPatient(i).subscribe((function(e){t.entity.patient=e,t.entity.facility=e.facility,t.dateBirth=e.dateBirth,t.dateRegistration=e.dateRegistration,"ART_TRANSFER_IN"===e.statusAtRegistration&&(t.dateRegistration=R("1999-01-01","YYYY-MM-DD"),t.dateRegistration.isBefore(t.entity.patient.dateBirth)&&(t.dateRegistration=t.entity.patient.dateBirth.clone().add(3,"months"))),e.extra&&e.extra.prep&&e.extra.prep.registered&&(t.prep=!0,t.clinicService.getRegimenLines().subscribe((function(e){t.regimenLines=e.filter((function(t){return 30===t.id}))}))),t.clinicService.enrolledOnOTZ(e.id).subscribe((function(e){t.enrolledOnOTZ=e,t.hasOtz=e})),t.otzApplicable=!R().subtract(24,"years").isAfter(t.entity.patient.dateBirth)&&!R().subtract(10,"years").isBefore(t.entity.patient.dateBirth),t.clinicService.getVisitDatesByPatient(t.entity.patient.id).subscribe((function(e){t.visitDates=e}))})),t.entity.commence&&t.entity.regimenType&&t.regimenLineChange(t.entity.regimenType),t.commence=t.commence||t.entity.commence,t.commence&&(t.entity.commence=!0,t.entity.regimenType&&t.regimenLineChange(t.entity.regimenType)),t.entity.id?(t.appointmentMin=t.entity.dateVisit.clone().add(14,"days"),t.appointmentMax=t.entity.dateVisit.clone().add(8,"months"),t.clinicService.adverseDrugReactions().subscribe((function(e){t.adverseDrugReactions=e,t.adr=!!t.entity.adverseDrugReactions,t.adverseDrugReactions.forEach((function(e){var n=!1;(t.entity.adverseDrugReactions||[]).forEach((function(i){i.adverseDrugReaction.id===e.id&&(n=!0,t.selectedClinicAdr.push(i))})),n||t.selectedClinicAdr.push({adverseDrugReaction:e})})),t.selectedClinicAdr=I(t.selectedClinicAdr),t.entity.extra&&(t.entity.extra.prep&&(t.hivTestResult=t.entity.extra.prep.hivTestResult,t.creatinineClearance=t.entity.extra.prep.creatinineClearance,t.hepatitisB=t.entity.extra.prep.hepatitisB,t.hepatitisC=t.entity.extra.prep.hepatitisC,t.urinalysis=t.entity.extra.prep.urinalysis),t.entity.extra.otz&&(t.entity.extra.otz.dateOfFullDisclosure&&(t.dateOfFullDisclosure=R(t.entity.extra.otz.dateOfFullDisclosure)),t.attendedLastOTZMeeting=!!t.entity.extra.otz.attendedLastOTZMeeting,t.enrolledOnOTZ=!!t.entity.extra.otz.enrolledOnOTZ,t.entity.extra.otz.dateEnrolledOnOTZ&&(t.dateEnrolledOnOTZ=R(t.entity.extra.otz.dateEnrolledOnOTZ)),t.entity.extra.otz.dateLastOTZMeeting&&(t.dateLastOTZMeeting=R(t.entity.extra.otz.dateLastOTZMeeting)),t.caregiverPhone=t.entity.extra.otz.caregiverPhone,t.caregiverAddress=t.entity.extra.otz.caregiverAddress,t.modulesCompleted=t.entity.extra.otz.modulesCompleted,t.fullDisclosure=t.entity.extra.otz.fullDisclosure))}))):(t.clinicService.adverseDrugReactions().subscribe((function(e){t.adverseDrugReactions=e,t.adverseDrugReactions.forEach((function(e){t.selectedClinicAdr.push({adverseDrugReaction:e})}))})),t.selectedClinicAdr=I(t.selectedClinicAdr))}))},t.prototype.updateValue=function(t,e,n){console.log("Edit",t,e,n),this.selectedClinicAdr=I(this.selectedClinicAdr.map((function(e){return e.adverseDrugReaction&&e.adverseDrugReaction.id===n.id&&(e.severity=t),e}))),console.log("UPDATED!",n,t)},t.prototype.filterDates=function(t){var e=!1;return this.visitDates.forEach((function(n){0===t.diff(n,"days")&&(e=!0)})),this.entity.id&&0===t.diff(this.entity.dateVisit,"days")||!e},t.prototype.dateChanged=function(t){this.appointmentMax=t.clone().add(6,"months"),this.lmpMin=t.clone().subtract(2,"years"),this.appointmentMin=t.clone().add(14,"days"),this.otzApplicable=!t.clone().subtract(24,"years").isAfter(this.entity.patient.dateBirth)&&!t.clone().subtract(10,"years").isBefore(this.entity.patient.dateBirth)},t.prototype.entityCompare=function(t,e){return i.entityCompare(t,e)},t.prototype.previousState=function(){window.history.back()},t.prototype.save=function(){this.isSaving=!0,this.entity.extra||(this.entity.extra={}),this.entity.extra.otz={},this.entity.extra.otz.fullDisclosure=this.fullDisclosure,this.entity.extra.otz.dateOfFullDisclosure=null!=this.dateOfFullDisclosure&&this.dateOfFullDisclosure.isValid()?this.dateOfFullDisclosure.format(i.DATE_FORMAT):null,this.entity.extra.otz.dateEnrolledOnOTZ=null!=this.dateEnrolledOnOTZ&&this.dateEnrolledOnOTZ.isValid()?this.dateEnrolledOnOTZ.format(i.DATE_FORMAT):null,this.entity.extra.otz.attendedLastOTZMeeting=!!this.attendedLastOTZMeeting,this.entity.extra.otz.dateLastOTZMeeting=null!=this.dateLastOTZMeeting&&this.dateLastOTZMeeting.isValid()?this.dateLastOTZMeeting.format(i.DATE_FORMAT):null,this.entity.extra.otz.enrolledOnOTZ=this.enrolledOnOTZ,this.entity.extra.otz.caregiverPhone=this.caregiverPhone,this.entity.extra.otz.caregiverAddress=this.caregiverAddress,this.entity.extra.otz.modulesCompleted=this.modulesCompleted,this.prep&&(this.entity.extra.prep={},this.entity.extra.prep.hivTestResult=this.hivTestResult,this.entity.extra.prep.creatinineClearance=this.creatinineClearance,this.entity.extra.prep.hepatitisB=this.hepatitisB,this.entity.extra.prep.hepatitisC=this.hepatitisC,this.entity.extra.prep.urinalysis=this.urinalysis),this.entity.adverseDrugReactions=this.selectedClinicAdr.filter((function(t){return!!t.severity})),this.entity.opportunisticInfections=this.oiList,this.entity.adheres=this.adhereList,this.appLoaderService.open("Saving clinic visit.."),void 0!==this.entity.id?this.subscribeToSaveResponse(this.clinicService.update(this.entity)):this.subscribeToSaveResponse(this.clinicService.create(this.entity))},t.prototype.regimenLineChange=function(t){var e=this;this.clinicService.getRegimenByLine(t.id).subscribe((function(t){return e.regimens=t}))},t.prototype.subscribeToSaveResponse=function(t){var e=this;t.subscribe((function(t){return e.onSaveSuccess(t.body)}),(function(t){e.onSaveError(),e.onError(t.message)}))},t.prototype.onSaveSuccess=function(t){this.appLoaderService.close(),this.isSaving=!1,this.notification.showInfo("Clinic visit successfully saved"),this.previousState()},t.prototype.onSaveError=function(){this.isSaving=!1,this.appLoaderService.close(),this.error=!0,this.notification.showError("Error occurred saving clinic visit; try again")},t.prototype.onError=function(t){this.appLoaderService.close(),this.notification.showError(t)},t.ctorParameters=function(){return[{type:w},{type:o.NotificationService},{type:l.ActivatedRoute},{type:i.AppLoaderService}]},t=g([e.Component({selector:"lamis-clinic-edit",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <form name="form" role="form" novalidate (ngSubmit)="save()" #clinicForm="ngForm">\n            <mat-card class="default">\n                <mat-card-content *ngIf="!!entity.patient">\n                    <ng-container *ngIf="commence === true">\n                        <div>\n                            <mat-form-field class="full-width">\n                                <input matInput [matDatepicker]="picker"\n                                       placeholder="ART Start Date"\n                                       [(ngModel)]="entity.dateVisit"\n                                       #visit="ngModel"\n                                       (dateChange)="dateChanged($event.value)"\n                                       [matDatepickerFilter]="filterDates.bind(this)"\n                                       [max]="today"\n                                       [min]="dateRegistration"\n                                       name="visit"\n                                       required>\n                                <mat-datepicker-toggle\n                                        matSuffix\n                                        [for]="picker">\n                                </mat-datepicker-toggle>\n                                <mat-datepicker #picker></mat-datepicker>\n                                <mat-error\n                                        *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.required)">\n                                    {{prep ? \'Date of PrEP Initiation \' : \'ART Start Date \'}}is required\n                                </mat-error>\n                                <mat-error\n                                        *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.min)">\n                                    Date of visit cannot be before {{dateRegistration | date: \'dd MMM, yyyy\'}}\n                                </mat-error>\n                                <mat-error\n                                        *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.max)">\n                                    {{prep ? \'Date of PrEP Initiation \' : \'ART Start Date \'}}cannot be in the future\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                        <div class="row" *ngIf="!prep">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <input matInput placeholder="CD4 at start of ART" [min]="0" type="number"\n                                           #cd4="ngModel" name="cd4" [(ngModel)]="entity.cd4"/>\n                                    <mat-error\n                                            *ngIf="cd4.errors && (cd4.dirty || cd4.touched) && (cd4.errors.min)">\n                                        Minimum CD4 is 0\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <input matInput placeholder="CD4 %" [min]="0" [max]="100" type="number"\n                                           #cd4p="ngModel" name="cd4p" [(ngModel)]="entity.cd4p"/>\n                                    <mat-error\n                                            *ngIf="cd4p.errors && (cd4p.dirty || cd4p.touched) && (cd4p.errors.min)">\n                                        Minimum CD4 % is 0\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="cd4p.errors && (cd4p.dirty || cd4p.touched) && (cd4p.errors.max)">\n                                        Maximum CD4 % is 100\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-select [(ngModel)]="entity.regimenType"\n                                                placeholder="Original Regimen Line"\n                                                #rtype="ngModel" required name="rt"\n                                                [compareWith]="entityCompare"\n                                                (selectionChange)="regimenLineChange($event.value)">\n                                        <mat-option>None</mat-option>\n                                        <mat-option *ngFor="let line of regimenLines"\n                                                    [value]="line">{{line.description}}</mat-option>\n                                        <mat-error\n                                                *ngIf="rtype.errors && (rtype.dirty || rtype.touched) && (rtype.errors.required)">\n                                            Regimen Line is required\n                                        </mat-error>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-select [(ngModel)]="entity.regimen"\n                                                placeholder="Original Regimen"\n                                                [compareWith]="entityCompare"\n                                                #rm="ngModel" required name="rm">\n                                        <mat-option>None</mat-option>\n                                        <mat-option *ngFor="let regimen of regimens"\n                                                    [value]="regimen">{{regimen.description}}</mat-option>\n                                        <mat-error\n                                                *ngIf="rm.errors && (rm.dirty || rm.touched) && (rm.errors.required)">\n                                            Regimen is required\n                                        </mat-error>\n                                    </mat-select>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                    </ng-container>\n                    <div *ngIf="commence === false || commence === undefined">\n                        <mat-form-field class="full-width">\n                            <input matInput [matDatepicker]="picker"\n                                   placeholder="Date of Visit"\n                                   [(ngModel)]="entity.dateVisit"\n                                   [matDatepickerFilter]="filterDates.bind(this)"\n                                   #visit="ngModel"\n                                   (dateChange)="dateChanged($event.value)"\n                                   [max]="today"\n                                   [min]="dateRegistration"\n                                   name="visit"\n                                   required>\n                            <mat-datepicker-toggle\n                                    matSuffix\n                                    [for]="picker">\n                            </mat-datepicker-toggle>\n                            <mat-datepicker #picker></mat-datepicker>\n                            <mat-error\n                                    *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.required)">\n                                Date of visit is required\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.min)">\n                                Date of visit cannot be before {{dateRegistration | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.max)">\n                                Date of visit cannot be in the future\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <ng-container *ngIf="otzApplicable && !hasOtz">\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-checkbox [(ngModel)]="fullDisclosure" name="fd">\n                                    Full Disclosure?\n                                </mat-checkbox>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width" *ngIf="fullDisclosure">\n                                    <input matInput [matDatepicker]="picker8"\n                                           placeholder="Date of Full Disclosure"\n                                           [(ngModel)]="dateOfFullDisclosure"\n                                           #dfd="ngModel"\n                                           [max]="today"\n                                           [min]="entity.patient.dateBirth"\n                                           name="dfd"\n                                           required>\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker8">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker8></mat-datepicker>\n                                    <mat-error\n                                            *ngIf="dfd.errors && (dfd.dirty || dfd.touched) && (dfd.errors.required)">\n                                        Date of Full Disclosure is required\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="dfd.errors && (dfd.dirty || dfd.touched) && (dfd.errors.min)">\n                                        Date of Full Disclosure cannot be before date of\n                                        birth {{entity.patient.dateBirth | date: \'dd MMM, yyyy\'}}\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="dfd.errors && (dfd.dirty || dfd.touched) && (dfd.errors.max)">\n                                        Date of Full Disclosure cannot be in the future\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <ng-container *ngIf="fullDisclosure && !hasOtz">\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="enrolledOnOTZ" name="otz">\n                                        Enrolled on OTZ?\n                                    </mat-checkbox>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width" *ngIf="enrolledOnOTZ">\n                                        <input matInput [matDatepicker]="picker7"\n                                               placeholder="Date Enrolled on OTZ"\n                                               [(ngModel)]="dateEnrolledOnOTZ"\n                                               #otze="ngModel"\n                                               [max]="today"\n                                               [min]="entity.patient.dateBirth"\n                                               name="otze"\n                                               [required]="enrolledOnOTZ">\n                                        <mat-datepicker-toggle\n                                                matSuffix\n                                                [for]="picker7">\n                                        </mat-datepicker-toggle>\n                                        <mat-datepicker #picker7></mat-datepicker>\n                                        <mat-error\n                                                *ngIf="otze.errors && (otze.dirty || otze.touched) && (otze.errors.required)">\n                                            Date enrolled on OTZ is required\n                                        </mat-error>\n                                        <mat-error\n                                                *ngIf="otze.errors && (otze.dirty || otze.touched) && (otze.errors.min)">\n                                            Date enrolled on OTZ cannot be before date of\n                                            birth {{entity.patient.dateBirth | date: \'dd MMM, yyyy\'}}\n                                        </mat-error>\n                                        <mat-error\n                                                *ngIf="otze.errors && (otze.dirty || otze.touched) && (otze.errors.max)">\n                                            Date enrolled on OTZ cannot be in the future\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <ng-container *ngIf="enrolledOnOTZ">\n                                <fieldset>\n                                    <legend>OTZ</legend>\n                                    <div class="row">\n                                        <div class="col-md-6">\n                                            <mat-form-field class="full-width">\n                                                <mat-label>Caregiver Phone</mat-label>\n                                                <input matInput name="phone" [(ngModel)]="caregiverPhone"\n                                                       #phone="ngModel"\n                                                       phoneNumber/>\n                                                <mat-error\n                                                        *ngIf="phone.errors && (phone.dirty || phone.touched) && (phone.errors.required)">\n                                                    Caregiver phone number is required\n                                                </mat-error>\n                                                <mat-error\n                                                        *ngIf="phone.errors && (phone.dirty || phone.touched || !!entity.id) && (phone.errors.phoneNumber)">\n                                                    Invalid phone number\n                                                </mat-error>\n                                            </mat-form-field>\n                                        </div>\n                                        <div class="col-md-6">\n                                            <mat-form-field class="full-width">\n                                                <mat-label>Caregiver Address</mat-label>\n                                                <textarea matInput name="address" [(ngModel)]="caregiverAddress"\n                                                          #address="ngModel"\n                                                          rows="2">\n                                            </textarea>\n                                                <mat-error\n                                                        *ngIf="address.errors && (address.dirty || address.touched) && (address.errors.required)">\n                                                    Case Manager address is required\n                                                </mat-error>\n                                            </mat-form-field>\n                                        </div>\n                                    </div>\n                                </fieldset>\n                            </ng-container>\n                        </ng-container>\n                    </ng-container>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <mat-select [(ngModel)]="entity.clinicStage"\n                                        placeholder="Clinical Stage"\n                                        #clinicStage="ngModel" name="cs">\n                                <mat-option>None</mat-option>\n                                <mat-option [value]="\'Stage I\'">Stage I</mat-option>\n                                <mat-option [value]="\'Stage II\'">Stage II</mat-option>\n                                <mat-option [value]="\'Stage III\'">Stage III</mat-option>\n                                <mat-option [value]="\'Stage IV\'">Stage IV</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <mat-select [(ngModel)]="entity.funcStatus"\n                                        placeholder="Functional Status"\n                                        #funcStatus="ngModel" name="fs">\n                                <mat-option>None</mat-option>\n                                <mat-option [value]="\'Working\'">Working</mat-option>\n                                <mat-option [value]="\'Ambulatory\'">Ambulatory</mat-option>\n                                <mat-option [value]="\'Bedridden\'">Bedridden</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <ng-container *ngIf="prep">\n                        <fieldset>\n                            <legend>PrEP</legend>\n                            <div *ngIf="commence">\n                                <mat-form-field class="full-width">\n                                    <mat-select [(ngModel)]="hivTestResult"\n                                                placeholder="HIV Status at PrEP Initiation"\n                                                required\n                                                #hivStatus="ngModel" name="htr">\n                                        <mat-option>None</mat-option>\n                                        <mat-option [value]="\'NEGATIVE\'">Negative</mat-option>\n                                        <mat-option [value]="\'POSITIVE\'">Positive</mat-option>\n                                    </mat-select>\n                                    <mat-error\n                                            *ngIf="hivStatus.errors && (hivStatus.dirty || hivStatus.touched) && (hivStatus.errors.required)">\n                                        HIV Status is required\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                            <div *ngIf="!commence">\n                                <mat-form-field class="full-width">\n                                    <mat-select [(ngModel)]="hivTestResult"\n                                                placeholder="HIV Status /Test Result"\n                                                required\n                                                #hivStatus="ngModel" name="htr">\n                                        <mat-option>None</mat-option>\n                                        <mat-option [value]="\'NEGATIVE\'">Negative</mat-option>\n                                        <mat-option [value]="\'POSITIVE\'">Positive</mat-option>\n                                        <mat-option [value]="\'NOT_DONE\'">Not Done</mat-option>\n                                    </mat-select>\n                                    <mat-error\n                                            *ngIf="hivStatus.errors && (hivStatus.dirty || hivStatus.touched) && (hivStatus.errors.required)">\n                                        HIV Status is required\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                            <ng-container *ngIf="commence">\n                                <div class="row">\n                                    <div class="col-md-6">\n                                        <mat-form-field class="full-width">\n                                            <input matInput [(ngModel)]="creatinineClearance"\n                                                   placeholder="Creatinine Clearance (mL/min)"\n                                                   #creatinine="ngModel" name="creatinine"/>\n                                        </mat-form-field>\n                                    </div>\n                                    <div class="col-md-6">\n                                        <mat-form-field class="full-width">\n                                            <mat-select [(ngModel)]="urinalysis"\n                                                        placeholder="Urinalysis"\n                                                        #urinal="ngModel" name="urinalysis">\n                                                <mat-option>None</mat-option>\n                                                <mat-option [value]="\'Normal\'">Normal</mat-option>\n                                                <mat-option [value]="\'Deranged\'">Deranged</mat-option>\n                                            </mat-select>\n                                        </mat-form-field>\n                                    </div>\n                                </div>\n                                <div class="row">\n                                    <div class="col-md-6">\n                                        <mat-form-field class="full-width">\n                                            <mat-select [(ngModel)]="hepatitisB"\n                                                        placeholder="Hepatitis B Screening"\n                                                        #hepatitisb="ngModel" name="hepatitisB">\n                                                <mat-option>None</mat-option>\n                                                <mat-option [value]="\'Positive\'">Positive</mat-option>\n                                                <mat-option [value]="\'Negative\'">Negative</mat-option>\n                                                <mat-option [value]="\'Not Done\'">Not Done</mat-option>\n                                            </mat-select>\n                                        </mat-form-field>\n                                    </div>\n                                    <div class="col-md-6">\n                                        <mat-form-field class="full-width">\n                                            <mat-select [(ngModel)]="hepatitisC"\n                                                        placeholder="Hepatitis C Screening"\n                                                        #hepatitisb="ngModel" name="hepatitisC">\n                                                <mat-option>None</mat-option>\n                                                <mat-option [value]="\'Positive\'">Positive</mat-option>\n                                                <mat-option [value]="\'Negative\'">Negative</mat-option>\n                                                <mat-option [value]="\'Not Done\'">Not Done</mat-option>\n                                            </mat-select>\n                                        </mat-form-field>\n                                    </div>\n                                </div>\n                            </ng-container>\n                        </fieldset>\n                    </ng-container>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <mat-select [(ngModel)]="entity.tbStatus"\n                                        placeholder="TB Status"\n                                        name="tb"\n                                        #tbStatus="ngModel">\n                                <mat-option>None</mat-option>\n                                <mat-option [value]="\'No sign or symptoms of TB\'">No sign or symptoms of TB</mat-option>\n                                <mat-option [value]="\'TB suspected and referred for evaluation\'">TB suspected and\n                                    referred\n                                    for evaluation\n                                </mat-option>\n                                <mat-option [value]="\'Currently on INH prophylaxis\'">Currently on INH prophylaxis\n                                </mat-option>\n                                <mat-option [value]="\'Currently on TB treatment\'">Currently on TB treatment</mat-option>\n                                <mat-option [value]="\'TB positive not on TB drugs\'">TB positive not on TB drugs\n                                </mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <input matInput placeholder="Body weight(Kg)" [min]="0" [max]="250" type="number"\n                                   #weight="ngModel" name="weight" [(ngModel)]="entity.bodyWeight"/>\n                            <mat-error\n                                    *ngIf="weight.errors && (weight.dirty || weight.touched) && (weight.errors.min)">\n                                Minimum body weight is 0\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="weight.errors && (weight.dirty || weight.touched) && (weight.errors.max)">\n                                Maximum body weight is 250\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <input matInput placeholder="Height (m)" [min]="0" [max]="1.8" type="number"\n                                   #height="ngModel" name="height" [(ngModel)]="entity.height"/>\n                            <mat-error\n                                    *ngIf="height.errors && (height.dirty || height.touched) && (height.errors.min)">\n                                Minimum height is 0\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="height.errors && (height.dirty || height.touched) && (height.errors.max)">\n                                Maximum height is 1.8m\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <fieldset>\n                        <h6>Blood Pressure(mmHg)</h6>\n                        <div class="row">\n                            <div class="col-md-3">\n                                <mat-form-field class="full-width">\n                                    <input matInput placeholder="Systolic"\n                                           name="bp1" type="number"\n                                           [max]="190"\n                                           [min]="70"\n                                           [required]="!!entity.bp2"\n                                           #bp1="ngModel" [(ngModel)]="entity.bp1"/>\n                                    <mat-error\n                                            *ngIf="bp1.errors && (bp1.dirty || bp1.touched) && (bp1.errors.max)">\n                                        Maximum Systolic is 190\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="bp1.errors && (bp1.dirty || bp1.touched) && (bp1.errors.min)">\n                                        Minimum Systolic is 70\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="bp1.errors && (bp1.dirty || bp1.touched) && (bp1.errors.required)">\n                                        Systolic is required\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                            <div class="col-md-3">\n                                <mat-form-field class="full-width">\n                                    <input matInput placeholder="Diastolic"\n                                           name="bp2" type="number"\n                                           [max]="100"\n                                           [min]="40"\n                                           [required]="!!entity.bp1"\n                                           #bp2="ngModel" [(ngModel)]="entity.bp2"/>\n                                    <mat-error\n                                            *ngIf="bp2.errors && (bp2.dirty || bp2.touched) && (bp2.errors.max)">\n                                        Maximum Diastolic is 100\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="bp2.errors && (bp2.dirty || bp2.touched) && (bp2.errors.min)">\n                                        Minimum Diastolic is 40\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="bp2.errors && (bp2.dirty || bp2.touched) && (bp2.errors.required)">\n                                        Diastolic is required\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                    </fieldset>\n                    <div *ngIf="entity.patient && entity.patient.gender === \'FEMALE\'">\n                        <mat-form-field class="full-width">\n                            <mat-select [(ngModel)]="entity.pregnancyStatus"\n                                        placeholder="Pregnancy Status"\n                                        #pregStatus="ngModel" name="ps">\n                                <mat-option>None</mat-option>\n                                <mat-option [value]="1">Not Pregnant</mat-option>\n                                <mat-option [value]="2">Pregnant</mat-option>\n                                <mat-option [value]="3">Breastfeeding</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div *ngIf="entity.patient && entity.patient.gender === \'FEMALE\' && lmpMin">\n                        <mat-form-field class="full-width">\n                            <input matInput [matDatepicker]="picker1"\n                                   placeholder="LMP"\n                                   [(ngModel)]="entity.lmp"\n                                   #lmp="ngModel"\n                                   [max]="entity.dateVisit"\n                                   [min]="lmpMin"\n                                   name="lmp">\n                            <mat-datepicker-toggle\n                                    matSuffix\n                                    [for]="picker1">\n                            </mat-datepicker-toggle>\n                            <mat-datepicker #picker1></mat-datepicker>\n                            <mat-error\n                                    *ngIf="lmp.errors && (lmp.dirty || lmp.touched) && (lmp.errors.max)">\n                                LMP cannot be after {{entity.dateVisit | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="lmp.errors && (lmp.dirty || lmp.touched) && (lmp.errors.min)">\n                                LMP cannot be before {{lmpMin | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <mat-select [(ngModel)]="oiList"\n                                        placeholder="Opportunistic Infections"\n                                        [compareWith]="entityCompare"\n                                        name="ois"\n                                        #oiIds="ngModel" multiple>\n                                <mat-option>None</mat-option>\n                                <mat-option *ngFor="let oi of opportunisticInfections"\n                                            [value]="oi">{{oi.description}}</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-4">\n                            <mat-checkbox [(ngModel)]="adr"\n                                          name="ad">Adverse Drug Reaction Screened?\n                            </mat-checkbox>\n                        </div>\n                        <div style="height: 300px; overflow-y: auto;" *ngIf="adr" class="col-md-8">\n                            <adf-datatable [rows]="selectedClinicAdr"\n                                           [stickyHeader]="true">\n                                <data-columns>\n                                    <data-column key="adverseDrugReaction.description" title="Description"\n                                                 sortable="true"></data-column>\n                                    <data-column key="severity" title="Severity" sortable="false">\n                                        <ng-template let-context="$implicit">\n                                            <mat-form-field class="full-width">\n                                                <mat-select autofocus\n                                                            [value]="context.row.getValue(\'severity\')"\n                                                            name="severity"\n                                                            (valueChange)="updateValue($event, \'severity\', context.row.getValue(\'adverseDrugReaction\'))">\n                                                    <mat-option>None</mat-option>\n                                                    <mat-option [value]="\'Grade 1\'">Grade 1</mat-option>\n                                                    <mat-option [value]="\'Grade 2\'">Grade 2</mat-option>\n                                                    <mat-option [value]="\'Grade 3\'">Grade 3</mat-option>\n                                                    <mat-option [value]="\'Grade 4\'">Grade 4</mat-option>\n                                                </mat-select>\n                                            </mat-form-field>\n                                        </ng-template>\n                                    </data-column>\n                                </data-columns>\n                            </adf-datatable>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-select [(ngModel)]="entity.adherenceLevel"\n                                            placeholder="Level of Adherence"\n                                            #adherence="ngModel" name="al">\n                                    <mat-option>None</mat-option>\n                                    <mat-option [value]="\'Good\'">Good</mat-option>\n                                    <mat-option [value]="\'Fair\'">Fair</mat-option>\n                                    <mat-option [value]="\'Poor\'">Poor</mat-option>\n                                </mat-select>\n                            </mat-form-field>\n                        </div>\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width"\n                                            *ngIf="entity.adherenceLevel === \'Fair\' || entity.adherenceLevel === \'Poor\'">\n                                <mat-select [(ngModel)]="adhereList"\n                                            placeholder="Adherence"\n                                            name="ads"\n                                            [compareWith]="entityCompare"\n                                            #adrIds="ngModel" multiple>\n                                    <mat-option>None</mat-option>\n                                    <mat-option *ngFor="let adhere of adheres"\n                                                [value]="adhere">{{adhere.description}}</mat-option>\n                                </mat-select>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <ng-container *ngIf="otzApplicable || enrolledOnOTZ">\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-checkbox [(ngModel)]="attendedLastOTZMeeting" name="aotz">\n                                    Attended last support group (OTZ club) meeting?\n                                </mat-checkbox>\n                            </div>\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width" *ngIf="attendedLastOTZMeeting">\n                                    <input matInput [matDatepicker]="picker8"\n                                           placeholder="Date of Last OTZ Club Meeting"\n                                           [(ngModel)]="dateLastOTZMeeting"\n                                           #lotzm="ngModel"\n                                           [max]="today"\n                                           [min]="dateEnrolledOnOTZ"\n                                           name="lotzm"\n                                           [required]="attendedLastOTZMeeting">\n                                    <mat-datepicker-toggle\n                                            matSuffix\n                                            [for]="picker8">\n                                    </mat-datepicker-toggle>\n                                    <mat-datepicker #picker8></mat-datepicker>\n                                    <mat-error\n                                            *ngIf="lotzm.errors && (lotzm.dirty || lotzm.touched) && (lotzm.errors.required)">\n                                        Date of Last OTZ meeting is required\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="lotzm.errors && (lotzm.dirty || lotzm.touched) && (lotzm.errors.min)">\n                                        Date of last OTZ meeting cannot be\n                                        before {{dateEnrolledOnOTZ | date: \'dd MMM, yyyy\'}}\n                                    </mat-error>\n                                    <mat-error\n                                            *ngIf="lotzm.errors && (lotzm.dirty || lotzm.touched) && (lotzm.errors.max)">\n                                        Date of last OTZ meeting cannot be in the future\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-6">\n                                <mat-form-field class="full-width">\n                                    <mat-select name="modules" [(ngModel)]="modulesCompleted" #modules="ngModel"\n                                                [required]="attendedLastOTZMeeting">\n                                        <mat-option></mat-option>\n                                        <mat-option [value]="1">1</mat-option>\n                                        <mat-option [value]="2">2</mat-option>\n                                        <mat-option [value]="3">3</mat-option>\n                                        <mat-option [value]="4">4</mat-option>\n                                        <mat-option [value]="5">5</mat-option>\n                                        <mat-option [value]="6">6</mat-option>\n                                        <mat-option [value]="7">7</mat-option>\n                                    </mat-select>\n                                    <mat-error\n                                            *ngIf="modules.errors && (modules.dirty || modules.touched) && (modules.errors.required)">\n                                        Number of modules attended required\n                                    </mat-error>\n                                </mat-form-field>\n                            </div>\n                        </div>\n                    </ng-container>\n                    <div *ngIf="!!appointmentMin">\n                        <mat-form-field class="full-width">\n                            <input matInput [matDatepicker]="picker2"\n                                   placeholder="Date of Next Appointment"\n                                   [(ngModel)]="entity.nextAppointment"\n                                   #na="ngModel"\n                                   [min]="appointmentMin"\n                                   [max]="appointmentMax"\n                                   name="na"\n                                   required>\n                            <mat-datepicker-toggle\n                                    matSuffix\n                                    [for]="picker2">\n                            </mat-datepicker-toggle>\n                            <mat-datepicker #picker2></mat-datepicker>\n                            <mat-error\n                                    *ngIf="na.errors && (na.dirty || na.touched) && (na.errors.required)">\n                                Date of next appointment is required\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="na.errors && (na.dirty || na.touched) && (na.errors.max)">\n                                Date of next appointment cannot be after {{appointmentMax | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="na.errors && (na.dirty || na.touched) && (na.errors.min)">\n                                Date of next appointment cannot be before {{appointmentMin | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <textarea matInput placeholder="Clinical Notes"\n                                      cols="30"\n                                      rows="3"\n                                      name="notes"\n                                      #note="ngModel" [(ngModel)]="entity.notes"></textarea>\n                        </mat-form-field>\n                    </div>\n                    <mat-card-actions class="lamis-edit-form-actions">\n                        <button mat-raised-button type="button" (click)="previousState()">Back</button>\n                        <button mat-raised-button color=\'primary\'\n                                [disabled]="clinicForm.invalid || isSaving"\n                                type="submit">\n                            {{entity.id !== undefined ? \'Update\' : \'Save\'}}\n                        </button>\n                    </mat-card-actions>\n                </mat-card-content>\n            </mat-card>\n        </form>\n    </div>\n</div>\n'}),M("design:paramtypes",[w,o.NotificationService,l.ActivatedRoute,i.AppLoaderService])],t)}(),A=function(){function t(t){this.service=t}return t.prototype.resolve=function(t,e){var n=t.params.id?t.params.id:null;return n?this.service.findByUuid(n).pipe(a.filter((function(t){return t.ok})),a.map((function(t){return t.body}))):p.of({})},t.ctorParameters=function(){return[{type:w}]},t=g([e.Injectable(),M("design:paramtypes",[w])],t)}(),L=[{path:"",data:{title:"Clinic Visit",breadcrumb:"CLINIC VISIT"},children:[{path:":id/patient/:patientId/view",component:E,resolve:{entity:A},data:{authorities:["ROLE_USER"],title:"Clinic Visit",breadcrumb:"CLINIC VISIT"}},{path:"patient/:patientId/new",component:x,data:{authorities:["ROLE_DEC"],title:"Clinic Visit",breadcrumb:"ADD CLINIC VISIT"}},{path:"art-commencement/patient/:patientId/new",component:x,data:{authorities:["ROLE_DEC"],title:"ART Commencement /PrEP Initiation",breadcrumb:"ADD ART COMMENCEMENT /PREP INITIATION",commence:!0}},{path:":id/patient/:patientId/edit",component:x,resolve:{entity:A},data:{authorities:["ROLE_DEC"],title:"Clinic Visit Edit",breadcrumb:"CLINIC VISIT EDIT"}}]}],T=function(){function t(t){this.clinicService=t,this.properties=[]}return t.prototype.ngOnInit=function(){var t=this;this.clinicService.latestVisit(this.patientId).subscribe((function(e){t.clinic=e,t.buildProperties()}))},t.prototype.buildProperties=function(){this.properties.push(new o.CardViewDateItemModel({key:"dv",value:this.clinic.dateVisit,label:"Last Clinic Visit",format:"dd MMM, yyyy"})),this.properties.push(new o.CardViewDateItemModel({key:"nv",value:this.clinic.nextAppointment,label:"Next Clinic Visit",format:"dd MMM, yyyy"})),this.properties.push(new o.CardViewTextItemModel({label:"Functional Status",key:"fs",value:this.clinic.funcStatus})),this.properties.push(new o.CardViewTextItemModel({label:"Clinical Stage",key:"cs",value:this.clinic.clinicStage})),this.properties.push(new o.CardViewTextItemModel({label:"TB Status",key:"ts",value:this.clinic.tbStatus})),this.properties.push(new o.CardViewFloatItemModel({label:"Body Weight(Kg)",key:"bw",value:this.clinic.bodyWeight}))},t.ctorParameters=function(){return[{type:w}]},g([e.Input(),M("design:type",Number)],t.prototype,"patientId",void 0),t=g([e.Component({selector:"clinic-widget",template:'<adf-card-view [properties]="properties"></adf-card-view>\n'}),M("design:paramtypes",[w])],t)}();
/*!
     * @license
     * Copyright 2016 Alfresco Software, Ltd.
     *
     * Licensed under the Apache License, Version 2.0 (the "License");
     * you may not use this file except in compliance with the License.
     * You may obtain a copy of the License at
     *
     *     http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
function D(){return[d.MatAutocompleteModule,d.MatButtonModule,d.MatCardModule,d.MatCheckboxModule,d.MatChipsModule,d.MatDatepickerModule,d.MatDialogModule,d.MatGridListModule,d.MatIconModule,d.MatInputModule,d.MatListModule,d.MatNativeDateModule,d.MatOptionModule,d.MatProgressSpinnerModule,d.MatRadioModule,d.MatRippleModule,d.MatSelectModule,d.MatSlideToggleModule,d.MatTableModule,d.MatTabsModule,d.MatMenuModule,d.MatProgressBarModule,d.MatSidenavModule,d.MatSnackBarModule,d.MatToolbarModule,d.MatTooltipModule,u.MatDatetimepickerModule,u.MatNativeDatetimeModule]}var V=function(){function t(){}return t=g([e.NgModule({imports:D(),exports:D()})],t)}(),P=function(){function t(){}return t=g([e.NgModule({imports:[s.CommonModule,V,o.CoreModule],declarations:[T],entryComponents:[T],exports:[T],providers:[]})],t)}(),O=function(){function t(){}return t=g([e.NgModule({declarations:[E,x],imports:[s.CommonModule,d.MatInputModule,d.MatIconModule,d.MatCardModule,d.MatSelectModule,d.MatButtonModule,l.RouterModule.forChild(L),d.MatProgressBarModule,c.CovalentMessageModule,c.CovalentDialogsModule,d.MatListModule,o.CoreModule,P,h.FormsModule,h.ReactiveFormsModule,i.MatDateFormatModule,f.CustomFormsModule,i.LamisSharedModule,m.NgxDatatableModule],exports:[E,x],entryComponents:[],providers:[A]})],t)}(),N=r,F=function(){function t(t,e){this.http=t,this.serverUrl=e,this.resourceUrl="",this.resourceUrl=e.SERVER_API_URL+"/api/chronic-cares"}return t.prototype.create=function(t){var e=this,n=this.convertDateFromClient(t);return this.http.post(this.resourceUrl,n,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.update=function(t){var e=this,n=this.convertDateFromClient(t);return this.http.put(this.resourceUrl,n,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.find=function(t){var e=this;return this.http.get(this.resourceUrl+"/"+t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.findByUuid=function(t){var e=this;return this.http.get(this.resourceUrl+"/by-uuid/"+t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.delete=function(t){return this.http.delete(this.resourceUrl+"/"+t,{observe:"response"})},t.prototype.getDmScreens=function(){return this.http.get(this.resourceUrl+"/dm-screens")},t.prototype.getTbScreens=function(){return this.http.get(this.resourceUrl+"/tb-screens")},t.prototype.getDmScreenByChronicCare=function(t){return this.http.get(this.resourceUrl+"/"+t+"/dm-screens")},t.prototype.getTbScreenByChronicCare=function(t){return this.http.get(this.resourceUrl+"/"+t+"/tb-screens")},t.prototype.getVisitDatesByPatient=function(t){return this.http.get(this.resourceUrl+"/patient/"+t+"/visit-dates").pipe(a.map((function(t){return t.forEach((function(t){return N(t)})),t})))},t.prototype.convertDateFromServer=function(t){return t.body&&(t.body.dateLastCd4=null!=t.body.dateLastCd4?N(t.body.dateLastCd4):null,t.body.dateVisit=null!=t.body.dateVisit?N(t.body.dateVisit):null,t.body.dateLastViralLoad=null!=t.body.dateLastViralLoad?N(t.body.dateLastViralLoad):null,t.body.dateStartedTbTreatment=null!=t.body.dateStartedTbTreatment?N(t.body.dateStartedTbTreatment):null),t},t.prototype.convertDateFromClient=function(t){return t=Object.assign({},t,{dateLastViralLoad:null!=t.dateLastViralLoad&&t.dateLastViralLoad.isValid()?t.dateLastViralLoad.format(i.DATE_FORMAT):null,dateVisit:null!=t.dateVisit&&t.dateVisit.isValid()?t.dateVisit.format(i.DATE_FORMAT):null,dateLastCd4:null!=t.dateLastCd4&&t.dateLastCd4.isValid()?t.dateLastCd4.format(i.DATE_FORMAT):null,dateStartedTbTreatment:null!=t.dateStartedTbTreatment&&t.dateStartedTbTreatment.isValid()?t.dateStartedTbTreatment.format(i.DATE_FORMAT):null})},t.ctorParameters=function(){return[{type:n.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[i.SERVER_API_URL_CONFIG]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(i.SERVER_API_URL_CONFIG))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"}),b(1,e.Inject(i.SERVER_API_URL_CONFIG)),M("design:paramtypes",[n.HttpClient,Object])],t)}(),B=function(){function t(t,e,n,i,a,r){this.router=t,this.route=e,this.chronicCareService=n,this._dialogService=i,this.notificationService=a,this.clinicService=r,this.properties=[]}return t.prototype.ngOnInit=function(){var t=this;this.route.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body:n;var i=t.route.snapshot.paramMap.get("patientId");t.clinicService.getPatient(i).subscribe((function(e){return t.entity.patient=e})),t.buildProperties()}))},t.prototype.edit=function(){this.router.navigate(["/","chronic-cares",this.entity.uuid,"patient",this.entity.patient.uuid,"edit"])},t.prototype.delete=function(){var t=this;this._dialogService.openConfirm({title:"Confirm",message:"Do you want to delete this chronic care visit, action cannot be reversed?",cancelButton:"No",acceptButton:"Yes",width:"500px"}).afterClosed().subscribe((function(e){e&&t.chronicCareService.delete(t.entity.id).subscribe((function(e){e.ok?t.router.navigate(["patients"]):t.notificationService.showError("Error deleting visit, please try again")}))}))},t.prototype.buildProperties=function(){},t.prototype.previousState=function(){window.history.back()},t.ctorParameters=function(){return[{type:l.Router},{type:l.ActivatedRoute},{type:F},{type:c.TdDialogService},{type:o.NotificationService},{type:w}]},t=g([e.Component({selector:"chronic-care-detail",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <mat-card>\n            <mat-card-header>\n            </mat-card-header>\n            <mat-card-content>\n                <adf-card-view [properties]="properties" editable="false"></adf-card-view>\n            </mat-card-content>\n            <mat-card-actions class="lamis-edit-form-actions">\n                <button mat-button (click)="previousState()">Back</button>\n                <button mat-raised-button color="warn" (click)="delete()">Delete</button>\n                <button mat-raised-button color="primary" (click)="edit()">Edit</button>\n            </mat-card-actions>\n        </mat-card>\n    </div>\n</div>\n'}),M("design:paramtypes",[l.Router,l.ActivatedRoute,F,c.TdDialogService,o.NotificationService,w])],t)}(),_=r,U=function(){function t(t,e,n,i,a){this.clinicService=t,this.chronicCareService=e,this.notification=n,this.activatedRoute=i,this.appLoaderService=a,this.today=_(),this.tbs=[],this.dms=[],this.visitDates=[],this.isSaving=!1,this.bmi="",this.bmiCalculated=""}return t.prototype.createEntity=function(){return{}},t.prototype.ngOnInit=function(){var t=this;this.activatedRoute.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body:n,void 0===t.entity&&(t.entity=t.createEntity());var i=t.activatedRoute.snapshot.paramMap.get("patientId");t.clinicService.getPatient(i).subscribe((function(e){t.entity.patient=e,t.entity.facility=e.facility,t.chronicCareService.getVisitDatesByPatient(t.entity.patient.id).subscribe((function(e){t.visitDates=e}))})),t.calculateBmi()}))},t.prototype.filterDates=function(t){var e=!1;return this.visitDates.forEach((function(n){0===t.diff(n,"days")&&(e=!0)})),this.entity.id&&0===t.diff(this.entity.dateVisit,"days")||!e},t.prototype.previousState=function(){window.history.back()},t.prototype.calculateBmi=function(){if(this.entity.bodyWeight&&this.entity.height){var t=this.entity.bodyWeight/Math.pow(this.entity.height,2);this.bmi=t<18.5?"<18.5 (Underweight)":t<24.9?"18.5 - 24.9 (Healthy)":t<29.9?"25.0 - 29.9 (Overweight)":t<40?"30 - 40 (Obesity)":">40 (Morbid Obesity)",this.bmiCalculated=t.toFixed(1)}else this.bmi=""},t.prototype.save=function(){this.isSaving=!0,this.appLoaderService.open("Saving chronic care visit.."),void 0!==this.entity.id?this.subscribeToSaveResponse(this.chronicCareService.update(this.entity)):this.subscribeToSaveResponse(this.chronicCareService.create(this.entity))},t.prototype.subscribeToSaveResponse=function(t){var e=this;t.subscribe((function(t){return e.onSaveSuccess(t.body)}),(function(t){e.onSaveError(),e.onError(t.message)}))},t.prototype.onSaveSuccess=function(t){this.appLoaderService.close(),this.isSaving=!1,this.notification.showInfo("Chronic Care visit successfully saved"),this.previousState()},t.prototype.onSaveError=function(){this.isSaving=!1,this.appLoaderService.close(),this.notification.showError("Error occurred saving chronic care visit; try again")},t.prototype.onError=function(t){this.appLoaderService.close(),this.notification.showError(t)},t.ctorParameters=function(){return[{type:w},{type:F},{type:o.NotificationService},{type:l.ActivatedRoute},{type:i.AppLoaderService}]},t=g([e.Component({selector:"chronic-care-edit",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <form name="form" role="form" novalidate (ngSubmit)="save()" #careForm="ngForm">\n            <mat-card class="default">\n                <mat-card-content>\n                    <mat-vertical-stepper #stepper *ngIf="entity.patient">\n                        <mat-step>\n                            <ng-template matStepLabel>Details</ng-template>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <input matInput [matDatepicker]="picker"\n                                               placeholder="Date of Visit"\n                                               [(ngModel)]="entity.dateVisit"\n                                               #visit="ngModel"\n                                               [matDatepickerFilter]="filterDates.bind(this)"\n                                               [max]="today"\n                                               [min]="entity.patient.dateRegistration"\n                                               name="visit"\n                                               required>\n                                        <mat-datepicker-toggle\n                                                matSuffix\n                                                [for]="picker">\n                                        </mat-datepicker-toggle>\n                                        <mat-datepicker #picker></mat-datepicker>\n                                        <mat-error\n                                                *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.required)">\n                                            Date of Visit is required\n                                        </mat-error>\n                                        <mat-error\n                                                *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.min)">\n                                            Date of Visit cannot be before {{entity.patient.dateRegistration}}\n                                        </mat-error>\n                                        <mat-error\n                                                *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.max)">\n                                            Date of Visit cannot be in the future\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row ">\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label class="form-label">Type of Client:</mat-label>\n                                        <mat-select name="clinicType" [(ngModel)]="entity.clientType" name="type">\n                                            <mat-option></mat-option>\n                                            <mat-option [value]="\'PLHIV newly enrolled into HIV Care & treatment\'">PLHIV\n                                                newly enrolled into HIV Care & treatment\n                                            </mat-option>\n                                            <mat-option [value]="\'Registered PLHIV on first time visit this FY\'">\n                                                Registered PLHIV on first time visit this FY\n                                            </mat-option>\n                                            <mat-option\n                                                    [value]="\'Registered PLHIV on follow up/subsequent visit this FY\'">\n                                                Registered PLHIV on follow up/subsequent visit this FY\n                                            </mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label class="form-label">ART Status</mat-label>\n                                        <mat-select name="currentStatus" [(ngModel)]="entity.currentStatus"\n                                                    name="status">\n                                            <mat-option></mat-option>\n                                            <mat-option [value]="\'Pre-ART\'">Pre-ART</mat-option>\n                                            <mat-option [value]="\'ART\'">ART</mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6" *ngIf="entity.patient.gender === \'Female\'">\n                                    <mat-form-field class="full-width">\n                                        <mat-label class="form-label">Pregnancy Status:</mat-label>\n                                        <mat-select name="pregnancyStatus" [(ngModel)]="entity.pregnancyStatus"\n                                                    name="preg">\n                                            <mat-option></mat-option>\n                                            <mat-option [value]="\'Pregnant\'">Pregnant</mat-option>\n                                            <mat-option [value]="\'Non-Pregnant\'">Non-Pregnant</mat-option>\n                                            <mat-option [value]="\'Post Partum\'">Post Partum</mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label class="form-label">Clinical Stage:</mat-label>\n                                        <mat-select name="clinicStage" [(ngModel)]="entity.clinicStage" name="stage">\n                                            <mat-option></mat-option>\n                                            <mat-option [value]="\'Stage I\'">Stage I</mat-option>\n                                            <mat-option [value]="\'Stage II\'">Stage II</mat-option>\n                                            <mat-option [value]="\'Stage III\'">Stage III</mat-option>\n                                            <mat-option [value]="\'Stage IV\'">Stage IV</mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label class="form-label">Last CD4 Count:</mat-label>\n                                        <input matInput type="number" name="lastCd4"\n                                               #lastCd4="ngModel"\n                                               [(ngModel)]="entity.lastCd4"\n                                               [required]="!!entity.dateLastCd4"\n                                               [min]="1"/>\n                                        <mat-error\n                                                *ngIf="lastCd4.errors && (lastCd4.dirty || lastCd4.touched) && (lastCd4.errors.min)">\n                                            Minimum value is 1\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <input matInput [matDatepicker]="picker1"\n                                               placeholder="Date of Last CD4"\n                                               [(ngModel)]="entity.dateLastCd4"\n                                               [required]="!!entity.lastCd4"\n                                               #cd4="ngModel"\n                                               name="cd4"\n                                               [max]="today"\n                                               [min]="entity.patient.dateRegistration">\n                                        <mat-datepicker-toggle\n                                                matSuffix\n                                                [for]="picker1">\n                                        </mat-datepicker-toggle>\n                                        <mat-datepicker #picker1></mat-datepicker>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label class="form-label">Last Viral Load Count:</mat-label>\n                                        <input matInput type="number" name="lastViral"\n                                               #lastViral="ngModel"\n                                               [(ngModel)]="entity.lastViralLoad"\n                                               [required]="!!entity.dateLastViralLoad"\n                                               [min]="1"/>\n                                        <mat-error\n                                                *ngIf="lastViral.errors && (lastViral.dirty || lastViral.touched) && (lastViral.errors.min)">\n                                            Minimum value is 1\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <input matInput [matDatepicker]="picker2"\n                                               placeholder="Date of Last Viral Load"\n                                               [(ngModel)]="entity.dateLastViralLoad"\n                                               [required]="!!entity.lastViralLoad"\n                                               #viral="ngModel"\n                                               name="viral"\n                                               [max]="today"\n                                               [min]="entity.patient.dateRegistration">\n                                        <mat-datepicker-toggle\n                                                matSuffix\n                                                [for]="picker2">\n                                        </mat-datepicker-toggle>\n                                        <mat-datepicker #picker2></mat-datepicker>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.eligibleCd4" name="cd">\n                                        Eligible for CD4\n                                    </mat-checkbox>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.eligibleViralLoad"\n                                                  name="vr">\n                                        Eligible for Viral Load\n                                    </mat-checkbox>\n                                </div>\n                            </div>\n                            <div>\n                                <button mat-button type="button" matStepperNext>Next</button>\n                            </div>\n                        </mat-step>\n                        <mat-step>\n                            <ng-template matStepLabel>Co-trimoxazole Eligibility Assessment</ng-template>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-list>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.plhivSymtomaticHiv"\n                                                          name="symt"\n                                            >\n                                                PLHIV with symptomatic HIV\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.plhivAsymtomaticCD4L500"\n                                                          name="sdym"\n                                            >\n                                                Asymptomatic PLHIV with CD4 count &lt;500 cells/mm<sup>3</sup>\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.plhivActiveTb"\n                                                          name="activeTb"\n                                            >\n                                                PLHIV with active TB\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox [(ngModel)]="entity.plhivPregnantAfter1stTrimester"\n                                                          name="ftm"\n                                            >\n                                                Pregnant PLHIV after the first trimester\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.plhivL5Years"\n                                                          name="l5"\n                                            >\n                                                LHIV &le; 5 years\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                </div>\n                            </div>\n                            <div>\n                                <button mat-button type="button" matStepperPrevious>Back</button>\n                                <button mat-button type="button" matStepperNext>Next</button>\n                            </div>\n                        </mat-step>\n                        <mat-step>\n                            <ng-template matStepLabel>TB Screening</ng-template>\n                            <div class="row ">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.tbTreatment"\n                                                  name="tbTreatment">\n                                        Are you currently on TB Treatment?\n                                    </mat-checkbox>\n                                    <div>\n                                    </div>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <input matInput [matDatepicker]="picker3"\n                                               placeholder="Date Started"\n                                               [(ngModel)]="entity.dateStartedTbTreatment"\n                                               [required]="entity.tbTreatment"\n                                               #started="ngModel"\n                                               name="started"\n                                               [max]="today"\n                                               [min]="entity.patient.dateRegistration">\n                                        <mat-datepicker-toggle\n                                                matSuffix\n                                                [for]="picker3">\n                                        </mat-datepicker-toggle>\n                                        <mat-datepicker #picker3></mat-datepicker>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row ">\n                                <div class="col-md-6">\n                                    <mat-list>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.tbReferred"\n                                                          name="tbReferred">\n                                                Referred for TB Diagnosis\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.ipt"\n                                                          name="ipt"\n                                            >\n                                                Are you currently on Isoniazid Preventive Therapy (IPT)?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.inh"\n                                                          name="inh"\n                                            >\n                                                Have you received INH within the past 2 year?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.eligibleIpt"\n                                                          name="iptEl"\n                                            >\n                                                Eligible for IPT\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                </div>\n                            </div>\n                        </mat-step>\n                        <mat-step>\n                            <ng-template matStepLabel>Nutritional Assessment</ng-template>\n                            <div class="row">\n                                <div class="col-md-3">\n                                    <mat-form-field class="full-width">\n                                        <input matInput placeholder="Body weight(Kg)" [min]="1" [max]="250"\n                                               type="number"\n                                               (change)="calculateBmi()"\n                                               #weight="ngModel" name="weight" [(ngModel)]="entity.bodyWeight"/>\n                                        <mat-error\n                                                *ngIf="weight.errors && (weight.dirty || weight.touched) && (weight.errors.min)">\n                                            Minimum body weight is 1\n                                        </mat-error>\n                                        <mat-error\n                                                *ngIf="weight.errors && (weight.dirty || weight.touched) && (weight.errors.max)">\n                                            Maximum body weight is 250\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-3">\n                                    <mat-form-field class="full-width">\n                                        <input matInput placeholder="Height (m)" [min]="0.2" [max]="1.8" type="number"\n                                               #height="ngModel" name="height" [(ngModel)]="entity.height"\n                                               (change)="calculateBmi()"/>\n                                        <mat-error\n                                                *ngIf="height.errors && (height.dirty || height.touched) && (height.errors.min)">\n                                            Minimum height is 0.2\n                                        </mat-error>\n                                        <mat-error\n                                                *ngIf="height.errors && (height.dirty || height.touched) && (height.errors.max)">\n                                            Maximum height is 1.8m\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-3">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>BMI Calculated</mat-label>\n                                        <input matInput disabled [value]="bmiCalculated">\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-3">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>BMI Range</mat-label>\n                                        <input matInput disabled [value]="bmi">\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-4">\n                                    <mat-form-field class="full-width">\n                                        <mat-label> MUAC (cm) (under 5yrs):</mat-label>\n                                        <input matInput [min]="2" [max]="26.5"\n                                               type="number"\n                                               #muac="ngModel" name="muac" [(ngModel)]="entity.muac"/>\n                                        <mat-error\n                                                *ngIf="muac.errors && (muac.dirty || muac.touched) && (muac.errors.min)">\n                                            Minimum Mid Upper Arm Circumference is 2\n                                        </mat-error>\n                                        <mat-error\n                                                *ngIf="muac.errors && (muac.dirty || muac.touched) && (muac.errors.max)">\n                                            Maximum Mid Upper Arm Circumference is 26.5\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-4">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>UAC Pediatrics</mat-label>\n                                        <mat-select name="muacPediatrics"\n                                                    [(ngModel)]="entity.muacPediatrics">\n                                            <mat-option></mat-option>\n                                            <mat-option [value]="\'<11.5cm (Severe Acute Malnutrition)\'">&lt;11.5cm\n                                                (Severe Acute Malnutrition)\n                                            </mat-option>\n                                            <mat-option [value]="\'11.5-12.5cm (Moderate Acute Malnutrition)\'">\n                                                11.5-12.5cm (Moderate Acute Malnutrition)\n                                            </mat-option>\n                                            <mat-option [value]="\'>12.5cm (Well nourished)\'">&gt;12.5cm (Well\n                                                nourished)\n                                            </mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                </div>\n                                <div class="col-md-4" *ngIf="entity.patient.gender === \'Female\'">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>MUAC Pregnant:</mat-label>\n                                        <mat-select name="muacPregnant" [(ngModel)]="entity.muacPregnant">\n                                            <mat-option></mat-option>\n                                            <mat-option [value]="\'<23cm (Underweight)\'">&lt;23cm (Underweight)\n                                            </mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-list>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.supplementaryFood"\n                                                          name="supp"\n                                            >\n                                                Provided with Therapeutic/Supplementary\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.nutritionalStatusReferred"\n                                                          name="nutr"\n                                            >\n                                                Referred\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                </div>\n                            </div>\n                            <div>\n                                <button mat-button type="button" matStepperPrevious>Back</button>\n                                <button mat-button type="button" matStepperNext>Next</button>\n                            </div>\n                        </mat-step>\n                        <mat-step>\n                            <ng-template matStepLabel>Gender Based Violence Screening</ng-template>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-list>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.sexuallyAbused"\n                                                          name="sexuallyAbused"\n                                            >\n                                                Have you been beaten, sexually coerced, raped or threatened or any of\n                                                these by your partner or anyone else?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.sexuallyAbusedReferred"\n                                                          *ngIf="entity.sexuallyAbused"\n                                                          name="sexuallyAbusedReferred"\n                                            >\n                                                Referred for Post GBV Care\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.essentialsDeniedByPartner"\n                                                          name="denied"\n                                            >\n                                                Does your partner/family deny you food, shelter, freedom of movement,\n                                                livelihood or finance to access health care?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.essentialsDeniedByPartnerReferred"\n                                                          *ngIf="entity.essentialsDeniedByPartner"\n                                                          name="deniedReferred"\n                                            >\n                                                Referred for Post GBV Care\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                </div>\n                            </div>\n                            <div>\n                                <button mat-button type="button" matStepperPrevious>Back</button>\n                                <button mat-button type="button" matStepperNext>Next</button>\n                            </div>\n                        </mat-step>\n                        <mat-step>\n                            <ng-template matStepLabel>Screening for Chronic Conditions</ng-template>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.hypertensive"\n                                                  name="hyper"\n                                    >\n                                        Known Hypertensive?\n                                    </mat-checkbox>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.firstHypertensive"\n                                                  *ngIf="entity.hypertensive"\n                                                  name="hyper1s"\n                                    >\n                                        First time identified within the programme\n                                    </mat-checkbox>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.bpAbove14090"\n                                                  name="bpAbove"\n                                    >\n                                        BP above 140/90mmHg\n                                    </mat-checkbox>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.bpReferred"\n                                                  *ngIf="entity.bpAbove14090"\n                                                  name="bpReferred"\n                                    >\n                                        Referred for further care\n                                    </mat-checkbox>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.diabetic"\n                                                  name="diabetic"\n                                    >\n                                        Known Diabetic?\n                                    </mat-checkbox>\n                                </div>\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.firstDiabetic"\n                                                  *ngIf="entity.diabetic"\n                                                  name="diabetic1st"\n                                    >\n                                        First Time Identified Within the Programme?\n                                    </mat-checkbox>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.dmReferred"\n                                                  name="dm"\n                                    >\n                                        Referred for further care\n                                    </mat-checkbox>\n                                </div>\n                            </div>\n                            <div>\n                                <button mat-button type="button" matStepperPrevious>Back</button>\n                                <button mat-button type="button" matStepperNext>Next</button>\n                            </div>\n                        </mat-step>\n                        <mat-step>\n                            <ng-template matStepLabel>Positive Health Dignity and Prevention(PHDP)</ng-template>\n                            <h5>A)Prevent HIV Transmission</h5>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>How many doses of ARVs have you missed since the last appointment?(If\n                                            on ART)\n                                        </mat-label>\n                                        <mat-select name="missed1" [(ngModel)]="entity.missedArvs">\n                                            <mat-option></mat-option>\n                                            <mat-option [value]="\'<=3\'">&le;3</mat-option>\n                                            <mat-option [value]="\'4-8\'">4-8</mat-option>\n                                            <mat-option [value]="\'>=9\'">&ge;9</mat-option>\n                                        </mat-select>\n                                    </mat-form-field>\n                                </div>\n                                <mat-list>\n                                    <mat-list-item>\n                                        <mat-checkbox [(ngModel)]="entity.missedArvsServicesProvided"\n                                                      name="missed1Referred"\n                                        >\n                                            Medication adherence counselling done?\n                                        </mat-checkbox>\n                                    </mat-list-item>\n                                    <mat-list-item>\n                                        <mat-checkbox [(ngModel)]="entity.statusDisclosedToPartner"\n                                                      name="sdtp"\n                                        >\n                                            Have you disclosed your status to your partner(s)?\n                                        </mat-checkbox>\n                                    </mat-list-item>\n                                    >\n                                    <mat-list-item>\n                                        <mat-checkbox [(ngModel)]="entity.partnerStatusKnown"\n                                                      name="psk"\n                                        >\n                                            Do you know the status of your partner(s)?\n                                        </mat-checkbox>\n                                    </mat-list-item>\n                                    <mat-list-item>\n                                        <mat-checkbox [(ngModel)]="entity.useCondomsAlways"\n                                                      name="uca"\n                                        >\n                                            Do you use condoms during every sexual encounter?\n                                        </mat-checkbox>\n                                    </mat-list-item>\n                                    <mat-list-item>\n                                        <mat-checkbox [(ngModel)]="entity.useCondomsAlwaysServicesProvided"\n                                                      name="ucasp"\n                                        >\n                                            Condom use counselling done?\n                                        </mat-checkbox>\n                                    </mat-list-item>\n                                </mat-list>\n                            </div>\n                            <mat-divider class="pb-1"></mat-divider>\n                            <h5>B)Prevent Diseases/Opportunistic Infections</h5>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-checkbox [(ngModel)]="entity.opportunisticInfections"\n                                                  name="oi"\n                                    >\n                                        Do you/partner have genital sores/rash/pain/discharge/bleeding?\n                                    </mat-checkbox>\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>How many doses of Co-trimoxazole have you missed since the last\n                                            appointment?\n                                        </mat-label>\n                                        <input matInput type="number" [(ngModel)]="entity.missedCotrim" [min]="1"\n                                               #missed="ngModel"\n                                               name="missed"/>\n                                        <mat-error\n                                                *ngIf="missed.errors && (missed.dirty || missed.touched) && (missed.errors.min)">\n                                            Minimum value is 1\n                                        </mat-error>\n                                    </mat-form-field>\n                                </div>\n                            </div>\n                            <mat-divider class="pb-1"></mat-divider>\n                            <h5>C)Promote Healthy Living</h5>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-form-field class="full-width">\n                                        <mat-label>How regularly do you take alcohol in a week?</mat-label>\n                                        <input matInput type="number" [(ngModel)]="entity.weeklyAlcoholConsumption"\n                                               [min]="1" #alcohol="ngModel"\n                                               name="alcohol"/>\n                                        <mat-error\n                                                *ngIf="alcohol.errors && (alcohol.dirty || alcohol.touched) && (alcohol.errors.min)">\n                                            Minimum value is 1\n                                        </mat-error>\n                                    </mat-form-field>\n                                    <mat-list>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.weeklyAlcoholConsumptionServicesProvided"\n                                                          name="alcolR"\n                                            >\n                                                Nutritional counseling done?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.washServicesProvided"\n                                                          name="wash"\n                                            >\n                                                WASH counseling done?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                </div>\n                            </div>\n                            <mat-divider class="pb-1"></mat-divider>\n                            <h5>Additional PHDP Services provided</h5>\n                            <div class="row">\n                                <div class="col-md-6">\n                                    <mat-list>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.useInsecticideNets"\n                                                          name="uin"\n                                            >\n                                                Insecticide treated nets\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox [(ngModel)]="entity.cervicalCancerScreening"\n                                                          name="ccs"\n                                            >\n                                                Cervical Cancer Screening\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.activeMemberOfSG"\n                                                          name="amsg"\n                                            >\n                                                Active member of SG\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.familyPlanning"\n                                                          name="fp"\n                                            >\n                                                Family Planning\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.basicCareKits"\n                                                          name="bck"\n                                            >\n                                                Basic care kits\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.disclosureCounseling"\n                                                          name="dc"\n                                            >\n                                                Disclosure counseling\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.socialServices"\n                                                          name="sc"\n                                            >\n                                                Social Services\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.linkageToIGA"\n                                                          name="liga"\n                                            >\n                                                Linkage to IGAs\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.legalServices"\n                                                          name="ls"\n                                            >\n                                                Legal Services\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.otherServices"\n                                                          name="ots"\n                                            >\n                                                Others\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                </div>\n                            </div>\n                            <div>\n                                <button mat-button type="button" matStepperPrevious>Back</button>\n                                <button mat-button type="button" matStepperNext>Next</button>\n                            </div>\n                        </mat-step>\n                        <mat-step>\n                            <ng-template matStepLabel>Reproductive Intentions</ng-template>\n                            <div class="row ">\n                                <div class="col-md-6">\n                                    <mat-list>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox [(ngModel)]="entity.cervicalCancerScreeningWithinPastYear"\n                                                          name="ccswpy"\n                                            >\n                                                Have you been screened for cervical cancer in the last one year?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox\n                                                    [(ngModel)]="entity.cervicalCancerScreeningWithinPastYearReferred"\n                                                    name="ccswpyr"\n                                            >\n                                                Referred for further care\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox [(ngModel)]="entity.wantPregnancyWithinAYear"\n                                                          name="wpwy"\n                                            >\n                                                Do you want a pregnancy in the next one year?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox [(ngModel)]="entity.wantPregnancyWithinAYearReferred"\n                                                          name="wpwar"\n                                            >\n                                                Referred for further care?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.currentlyUsingContraceptive"\n                                                          name="cuc"\n                                            >\n                                                If no, are you currently using a contraceptive?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.currentlyUsingContraceptiveReferred"\n                                                          name="cucr"\n                                            >\n                                                Referred for further care?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                    <mat-divider class="pb-1"></mat-divider>\n                                    <h5>Malaria Prevention</h5>\n                                    <mat-list>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.useInsecticideBedNet"\n                                                          name="uibn"\n                                            >\n                                                Do you use insecticide treated bed net?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item>\n                                            <mat-checkbox [(ngModel)]="entity.useInsecticideBedNetReferred"\n                                                          name="uibnr"\n                                            >\n                                                Referred?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox [(ngModel)]="entity.pregnantIntermittentPreventiveTherapy"\n                                                          name="pipt"\n                                            >\n                                                If pregnant: have you been on intermittent preventive therapy?\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                        <mat-list-item *ngIf="entity.patient.gender === \'Female\'">\n                                            <mat-checkbox\n                                                    [(ngModel)]="entity.pregnantIntermittentPreventiveTherapyReferred"\n                                                    name="piptr"\n                                            >\n                                                Referred\n                                            </mat-checkbox>\n                                        </mat-list-item>\n                                    </mat-list>\n                                </div>\n                            </div>\n                            <div>\n                                <button mat-button type="button" matStepperPrevious>Back</button>\n                            </div>\n                        </mat-step>\n                    </mat-vertical-stepper>\n                    <mat-divider></mat-divider>\n                </mat-card-content>\n                <mat-card-actions class="lamis-edit-form-actions">\n                    <button mat-raised-button type="button" (click)="previousState()">Back</button>\n                    <button mat-raised-button color=\'primary\'\n                            [disabled]="careForm.invalid || isSaving"\n                            type="submit">\n                        {{entity.id !== undefined ? \'Update\' : \'Save\'}}\n                    </button>\n                </mat-card-actions>\n            </mat-card>\n        </form>\n    </div>\n</div>\n'}),M("design:paramtypes",[w,F,o.NotificationService,l.ActivatedRoute,i.AppLoaderService])],t)}(),q=function(){function t(t){this.service=t}return t.prototype.resolve=function(t,e){var n=t.params.id?t.params.id:null;return n?this.service.findByUuid(n).pipe(a.filter((function(t){return t.ok})),a.map((function(t){return t.body}))):p.of({})},t.ctorParameters=function(){return[{type:F}]},t=g([e.Injectable(),M("design:paramtypes",[F])],t)}(),z=[{path:"",data:{title:"Chronic Care Visit",breadcrumb:"CHRONIC CARE VISIT"},children:[{path:":id/patient/:patientId/view",component:B,resolve:{entity:q},data:{authorities:["ROLE_USER"],title:"Chronic Care Visit",breadcrumb:"CHRONIC CARE VISIT"}},{path:"patient/:patientId/new",component:U,data:{authorities:["ROLE_DEC"],title:"Chronic Care Visit",breadcrumb:"ADD CHRONIC CARE VISIT"}},{path:":id/patient/:patientId/edit",component:U,resolve:{entity:q},data:{authorities:["ROLE_DEC"],title:"Chronic Care Visit Edit",breadcrumb:"CHRONIC CARE VISIT EDIT"}}]}],H=function(){function t(){}return t=g([e.NgModule({declarations:[B,U],imports:[s.CommonModule,c.CovalentDialogsModule,h.FormsModule,h.ReactiveFormsModule,i.LamisSharedModule,V,o.CoreModule,f.CustomFormsModule,i.MatDateFormatModule,l.RouterModule.forChild(z),d.MatStepperModule],providers:[q]})],t)}(),j=r,G=function(){function t(t,e){this.http=t,this.serverUrl=e,this.resourceUrl="",this.resourceUrl=e.SERVER_API_URL+"/api/eacs"}return t.prototype.create=function(t){var e=this,n=this.convertDateFromClient(t);return this.http.post(this.resourceUrl,n,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.update=function(t){var e=this,n=this.convertDateFromClient(t);return this.http.put(this.resourceUrl,n,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.find=function(t){var e=this;return this.http.get(this.resourceUrl+"/"+t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.findByUuid=function(t){var e=this;return this.http.get(this.resourceUrl+"/by-uuid/"+t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.delete=function(t){return this.http.delete(this.resourceUrl+"/"+t,{observe:"response"})},t.prototype.getLatestByPatient=function(t){var e=this;return this.http.get(this.resourceUrl+"/patient/"+t,{observe:"response"}).pipe(a.map((function(t){return e.convertDateFromServer(t)})))},t.prototype.getLatestViralLoadByPatient=function(t,e){var n=e.format(i.DATE_FORMAT);return this.http.get(this.resourceUrl+"/patient/"+t+"/viral-load-result/at/"+n,{observe:"response"}).pipe(a.map((function(t){return t.body&&(t.body.laboratory.dateReported=null!=t.body.laboratory.dateReported?j(t.body.laboratory.dateReported):null),t})))},t.prototype.convertDateFromClient=function(t){return Object.assign({},t,{dateEac1:null!=t.dateEac1&&t.dateEac1.isValid()?t.dateEac1.format(i.DATE_FORMAT):null,dateEac2:null!=t.dateEac2&&t.dateEac2.isValid()?t.dateEac2.format(i.DATE_FORMAT):null,dateEac3:null!=t.dateEac3&&t.dateEac3.isValid()?t.dateEac3.format(i.DATE_FORMAT):null,dateSampleCollected:null!=t.dateSampleCollected&&t.dateSampleCollected.isValid()?t.dateSampleCollected.format(i.DATE_FORMAT):null,dateLastViralLoad:null!=t.dateLastViralLoad&&t.dateLastViralLoad.isValid()?t.dateLastViralLoad.format(i.DATE_FORMAT):null})},t.prototype.convertDateFromServer=function(t){return t.body&&(t.body.dateLastViralLoad=null!=t.body.dateLastViralLoad?j(t.body.dateLastViralLoad):null,t.body.dateEac1=null!=t.body.dateEac1?j(t.body.dateEac1):null,t.body.dateEac2=null!=t.body.dateEac2?j(t.body.dateEac2):null,t.body.dateEac3=null!=t.body.dateEac3?j(t.body.dateEac3):null,t.body.dateSampleCollected=null!=t.body.dateSampleCollected?j(t.body.dateSampleCollected):null),t},t.ctorParameters=function(){return[{type:n.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[i.SERVER_API_URL_CONFIG]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(i.SERVER_API_URL_CONFIG))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"}),b(1,e.Inject(i.SERVER_API_URL_CONFIG)),M("design:paramtypes",[n.HttpClient,Object])],t)}(),Z=function(){function t(t,e,n,i,a){this.router=t,this.route=e,this._dialogService=n,this.notificationService=i,this.eacService=a,this.properties=[]}return t.prototype.ngOnInit=function(){var t=this;this.route.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body:n,t.buildProperties()}))},t.prototype.edit=function(){this.router.navigate(["/","eacs",this.entity.uuid,"patient",this.entity.patient.uuid,"edit"])},t.prototype.delete=function(){var t=this;this._dialogService.openConfirm({title:"Confirm",message:"Do you want to delete this EAC Record, action cannot be reversed?",cancelButton:"No",acceptButton:"Yes",width:"500px"}).afterClosed().subscribe((function(e){e&&t.eacService.delete(t.entity.id).subscribe((function(e){e.ok?t.router.navigate(["patients"]):t.notificationService.showError("Error deleting visit, please try again")}))}))},t.prototype.buildProperties=function(){this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.entity.dateLastViralLoad,label:"Date Last Viral Load",format:"dd MMM, yyyy"})),this.properties.push(new o.CardViewTextItemModel({key:"vl",value:this.entity.lastViralLoad,label:"Last Viral Load"})),this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.entity.dateEac1,label:"Date of 1st EAC Session",format:"dd MMM, yyyy"})),this.entity.dateEac2&&this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.entity.dateEac2,label:"Date of 2nd EAC Session",format:"dd MMM, yyyy"})),this.entity.dateEac3&&this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.entity.dateEac3,label:"Date of 3rd EAC Session",format:"dd MMM, yyyy"})),this.entity.dateEac3&&this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.entity.dateSampleCollected,label:"Date of Repeat VL Sample Collection",format:"dd MMM, yyyy"})),this.properties.push(new o.CardViewTextItemModel({label:"Notes",key:"ts",value:this.entity.notes}))},t.prototype.previousState=function(){window.history.back()},t.ctorParameters=function(){return[{type:l.Router},{type:l.ActivatedRoute},{type:c.TdDialogService},{type:o.NotificationService},{type:G}]},t=g([e.Component({selector:"eac-details",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <mat-card>\n            <mat-card-header>\n            </mat-card-header>\n            <mat-card-content>\n                <adf-card-view [properties]="properties" editable="false"></adf-card-view>\n            </mat-card-content>\n            <mat-card-actions class="lamis-edit-form-actions">\n                <button mat-button (click)="previousState()">Back</button>\n                <button mat-raised-button color="warn" (click)="delete()">Delete</button>\n                <button mat-raised-button color="primary" (click)="edit()">Edit</button>\n            </mat-card-actions>\n        </mat-card>\n    </div>\n</div>\n'}),M("design:paramtypes",[l.Router,l.ActivatedRoute,c.TdDialogService,o.NotificationService,G])],t)}(),Y=r,W=function(){function t(t,e,n,i,a){this.clinicService=t,this.eacService=e,this.notification=n,this.activatedRoute=i,this.appLoaderService=a,this.today=Y(),this.isSaving=!1}return t.prototype.createEntity=function(){return{}},t.prototype.ngOnInit=function(){var t=this;this.activatedRoute.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body:n,void 0===t.entity&&(t.entity=t.createEntity());var i=t.activatedRoute.snapshot.paramMap.get("patientId");t.clinicService.getPatient(i).subscribe((function(e){t.entity.patient=e,t.entity.facility=e.facility,t.dateRegistration=e.dateRegistration,t.updateMinDates(e.id,Y()),t.entity.id||t.eacService.getLatestByPatient(e.uuid).subscribe((function(e){t.entity=e.ok?e.body:t.createEntity(),t.repeatVLMin=t.entity.dateEac3?t.entity.dateEac3.clone().add(1,"day"):t.entity.dateLastViralLoad,t.eac2Min=t.entity.dateEac1?t.entity.dateEac1.clone().add(2,"week"):t.entity.dateLastViralLoad,t.eac3Min=t.entity.dateEac2?t.entity.dateEac2.clone().add(2,"week"):t.entity.dateLastViralLoad}))}))}))},t.prototype.updateMinDates=function(t,e){var n=this;this.eacService.getLatestViralLoadByPatient(t,e).pipe(a.tap((function(t){n.entity.dateLastViralLoad=Y(t.laboratory.dateResultReceived),n.entity.lastViralLoad=t.result,n.eac1Min=n.entity.dateLastViralLoad.clone().add(1,"day"),n.eac2Min=n.entity.dateEac1?n.entity.dateEac1.clone().add(2,"week"):n.entity.dateLastViralLoad,n.eac3Min=n.entity.dateEac2?n.entity.dateEac2.clone().add(2,"week"):n.entity.dateLastViralLoad,n.repeatVLMin=n.entity.dateEac3?n.entity.dateEac3.clone().add(1,"day"):n.entity.dateLastViralLoad})),a.catchError((function(t){return n.entity.dateLastViralLoad=null,n.entity.lastViralLoad=null,n.eac1Min=n.entity.patient.dateRegistration.clone().add(1,"day"),n.eac2Min=n.entity.dateEac1?n.entity.dateEac1.clone().add(2,"week"):n.entity.dateLastViralLoad,n.eac3Min=n.entity.dateEac2?n.entity.dateEac2.clone().add(2,"week"):n.entity.dateLastViralLoad,n.repeatVLMin=n.entity.dateEac3?n.entity.dateEac3.clone().add(1,"day"):n.entity.dateLastViralLoad,null})))},t.prototype.dateEac1Changed=function(t){this.eac2Min=t.clone().add(2,"weeks"),this.updateMinDates(this.entity.patient.id,t)},t.prototype.dateEac2Changed=function(t){this.eac3Min=t.clone().add(2,"weeks")},t.prototype.dateEac3Changed=function(t){this.repeatVLMin=t.clone().add(1,"days"),this.repeatVLMax=t.clone().add(6,"months")},t.prototype.save=function(){this.isSaving=!0,this.appLoaderService.open("Saving EAC session.."),void 0!==this.entity.id?this.subscribeToSaveResponse(this.eacService.update(this.entity)):this.subscribeToSaveResponse(this.eacService.create(this.entity))},t.prototype.previousState=function(){window.history.back()},t.prototype.subscribeToSaveResponse=function(t){var e=this;t.subscribe((function(t){return e.onSaveSuccess(t.body)}),(function(t){e.onSaveError(),e.onError(t.message)}))},t.prototype.onSaveSuccess=function(t){this.appLoaderService.close(),this.isSaving=!1,this.notification.openSnackMessage("EAC session successfully saved"),this.previousState()},t.prototype.onSaveError=function(){this.isSaving=!1,this.appLoaderService.close(),this.notification.showError("Error occurred saving EAC session; try again")},t.prototype.onError=function(t){this.appLoaderService.close(),this.notification.showError(t)},t.ctorParameters=function(){return[{type:w},{type:G},{type:o.NotificationService},{type:l.ActivatedRoute},{type:i.AppLoaderService}]},t=g([e.Component({selector:"eac-edit",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <mat-card class="default">\n            <mat-card-content>\n                <mat-progress-bar mode="determinate" class="session-progress"></mat-progress-bar>\n            </mat-card-content>\n        </mat-card>\n        <form name="form" role="form" novalidate (ngSubmit)="save()" #clinicForm="ngForm">\n            <mat-card class="default">\n                <mat-card-content *ngIf="entity.patient">\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field>\n                                <mat-label>Date Last Viral Load</mat-label>\n                                <input matInput\n                                       [value]="entity.dateLastViralLoad && entity.dateLastViralLoad.format(\'DD MMM, YYYY\')"\n                                       disabled>\n                            </mat-form-field>\n                        </div>\n                        <div class="col-md-6">\n                            <mat-form-field>\n                                <input matInput [value]="entity.lastViralLoad" disabled>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <input matInput [matDatepicker]="picker"\n                                   placeholder="Date of 1st EAC Session"\n                                   [(ngModel)]="entity.dateEac1"\n                                   #visit="ngModel"\n                                   (dateChange)="dateEac1Changed($event.value)"\n                                   [max]="today"\n                                   [min]="eac1Min"\n                                   name="visit"\n                                   required>\n                            <mat-datepicker-toggle\n                                    matSuffix\n                                    [for]="picker">\n                            </mat-datepicker-toggle>\n                            <mat-datepicker #picker></mat-datepicker>\n                            <mat-error\n                                    *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.required)">\n                                Date of first EAC session is required\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.min)">\n                                Date of first EAC session cannot be before {{eac1Min | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.max)">\n                                Date of first EAC session cannot be after {{today | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width" *ngIf="entity.id && !!eac2Min">\n                            <input matInput [matDatepicker]="picker2"\n                                   placeholder="Date of 2nd EAC Session"\n                                   [(ngModel)]="entity.dateEac2"\n                                   #visit2="ngModel"\n                                   (dateChange)="dateEac2Changed($event.value)"\n                                   [max]="today"\n                                   [min]="eac2Min"\n                                   name="visit2">\n                            <mat-datepicker-toggle\n                                    matSuffix\n                                    [for]="picker2">\n                            </mat-datepicker-toggle>\n                            <mat-datepicker #picker2></mat-datepicker>\n                            <mat-error\n                                    *ngIf="visit2.errors && (visit2.dirty || visit2.touched) && (visit2.errors.required)">\n                                Date of second EAC session is required\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit2.errors && (visit2.dirty || visit2.touched) && (visit2.errors.min)">\n                                Date of second EAC session cannot be before {{eac2Min | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit2.errors && (visit2.dirty || visit2.touched) && (visit2.errors.max)">\n                                Date of second EAC session cannot be after {{today | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width" *ngIf="entity.dateEac2 && !!eac3Min">\n                            <input matInput [matDatepicker]="picker3"\n                                   placeholder="Date of 3rd EAC Session"\n                                   [(ngModel)]="entity.dateEac3"\n                                   #visit3="ngModel"\n                                   (dateChange)="dateEac3Changed($event.value)"\n                                   [max]="today"\n                                   [min]="eac3Min"\n                                   name="visit3">\n                            <mat-datepicker-toggle\n                                    matSuffix\n                                    [for]="picker3">\n                            </mat-datepicker-toggle>\n                            <mat-datepicker #picker3></mat-datepicker>\n                            <mat-error\n                                    *ngIf="visit3.errors && (visit3.dirty || visit3.touched) && (visit3.errors.required)">\n                                Date of third EAC session is required\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit3.errors && (visit3.dirty || visit3.touched) && (visit3.errors.min)">\n                                Date of third EAC session cannot be before {{eac3Min | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit3.errors && (visit3.dirty || visit3.touched) && (visit3.errors.max)">\n                                Date of third EAC session cannot be after {{today | date: \'dd MMM, yyyy\'}}\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width" *ngIf="entity.dateEac3 && !!repeatVLMin">\n                            <input matInput [matDatepicker]="picker4"\n                                   placeholder="Date of Repeat VL Sample Collection"\n                                   [(ngModel)]="entity.dateSampleCollected"\n                                   #visit4="ngModel"\n                                   [max]="repeatVLMax"\n                                   [min]="repeatVLMin"\n                                   name="repeat">\n                            <mat-datepicker-toggle\n                                    matSuffix\n                                    [for]="picker4">\n                            </mat-datepicker-toggle>\n                            <mat-datepicker #picker4></mat-datepicker>\n                            <mat-error\n                                    *ngIf="visit4.errors && (visit4.dirty || visit4.touched) && (visit4.errors.required)">\n                                Date of Repeat VL Sample Collection is required\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit4.errors && (visit4.dirty || visit4.touched) && (visit4.errors.min)">\n                                Date of Repeat VL Sample Collection cannot be\n                                before {{repeatVLMin | date:\'dd MMM, yyyy\'}}\n                            </mat-error>\n                            <mat-error\n                                    *ngIf="visit4.errors && (visit4.dirty || visit4.touched) && (visit4.errors.max)">\n                                Date of Repeat VL Sample Collection cannot be\n                                after {{repeatVLMax | date:\'dd MMM, yyyy\'}}\n                            </mat-error>\n                        </mat-form-field>\n                    </div>\n                    <div>\n                        <mat-form-field class="full-width">\n                            <textarea matInput placeholder="Notes"\n                                      cols="30"\n                                      rows="3"\n                                      name="notes"\n                                      #note="ngModel" [(ngModel)]="entity.notes"></textarea>\n                        </mat-form-field>\n                    </div>\n                    <mat-card-actions class="lamis-edit-form-actions">\n                        <button mat-raised-button type="button" (click)="previousState()">Back</button>\n                        <button mat-raised-button color=\'primary\'\n                                [disabled]="clinicForm.invalid || isSaving"\n                                type="submit">\n                            {{entity.id !== undefined ? \'Update\' : \'Save\'}}\n                        </button>\n                    </mat-card-actions>\n                </mat-card-content>\n            </mat-card>\n        </form>\n    </div>\n</div>\n'}),M("design:paramtypes",[w,G,o.NotificationService,l.ActivatedRoute,i.AppLoaderService])],t)}(),$=function(){function t(t){this.service=t}return t.prototype.resolve=function(t,e){var n=t.params.id?t.params.id:null;return n?this.service.findByUuid(n).pipe(a.filter((function(t){return t.ok})),a.map((function(t){return t.body}))):p.of({})},t.ctorParameters=function(){return[{type:G}]},t=g([e.Injectable(),M("design:paramtypes",[G])],t)}(),K=[{path:"",data:{title:"EAC Session",breadcrumb:"EAC SESSION"},children:[{path:":id/patient/:patientId/view",component:Z,resolve:{entity:$},data:{authorities:["ROLE_USER"],title:"EAC Session",breadcrumb:"EAC SESSION"}},{path:"patient/:patientId/new",component:W,data:{authorities:["ROLE_DEC"],title:"EAC Session",breadcrumb:"ADD EAC SESSION",commence:!0}},{path:":id/patient/:patientId/edit",component:W,resolve:{entity:$},data:{authorities:["ROLE_DEC"],title:"EAC Session Edit",breadcrumb:"EAC SESSION EDIT"}}]}],X=function(){function t(){}return t=g([e.NgModule({imports:[s.CommonModule,c.CovalentDialogsModule,h.FormsModule,h.ReactiveFormsModule,i.LamisSharedModule,V,o.CoreModule,f.CustomFormsModule,i.MatDateFormatModule,l.RouterModule.forChild(K)],declarations:[Z,W],providers:[$]})],t)}(),J=function(){function t(t,e){this.http=t,this.serverUrl=e,this.resourceUrl="",this.resourceUrl=e.SERVER_API_URL+"/api/case-management"}return t.prototype.initClients=function(t){return this.http.get(this.resourceUrl+"/init-clients/"+t)},t.prototype.getClientList=function(t){return this.http.post(this.resourceUrl+"/client-list",t,{observe:"response"})},t.prototype.getCaseManagerStats=function(t,e){return this.http.get(this.resourceUrl+"/facility/"+e+"/case-manager/"+t+"/stats")},t.prototype.getActiveFacility=function(){return this.http.get("/api/facilities/active")},t.prototype.getCaseManagers=function(t){return this.http.get(this.resourceUrl+"/facility/"+t+"/case-managers")},t.prototype.assignToCaseManager=function(t,e){var i=new n.HttpParams;return e.forEach((function(t){return i=i.append("ids",t.toString())})),this.http.get(this.resourceUrl+"/case-manager/"+t+"/assign-clients",{params:i,observe:"response"})},t.prototype.deAssignClients=function(t){var e=new n.HttpParams;return t.forEach((function(t){return e=e.append("ids",t.toString())})),this.http.get(this.resourceUrl+"/de-assign-clients",{params:e,observe:"response"})},t.prototype.getStates=function(){return this.http.get("/api/states")},t.prototype.getLgasByState=function(t){return this.http.get("/api/provinces/state/"+t)},t.ctorParameters=function(){return[{type:n.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[i.SERVER_API_URL_CONFIG]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(i.SERVER_API_URL_CONFIG))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"}),b(1,e.Inject(i.SERVER_API_URL_CONFIG)),M("design:paramtypes",[n.HttpClient,Object])],t)}(),Q=function(){function t(t,e,n,i){this.service=t,this._dialogService=e,this.notificationService=n,this.stompService=i,this.caseManagers=[],this.patients=[],this.properties=[],this.globalProperties=[],this.stats={},this.globalStats={},this.filter={},this.hospitalNum="",this.totalItems=0,this.page=0,this.itemsPerPage=20,this.loading=!0,this.initializing=!0,this.filterByCaseManager=!1}return t.prototype.ngOnInit=function(){var t=this;this.service.getActiveFacility().subscribe((function(e){e&&(t.facilityId=e.id,t.service.initClients(e.id).subscribe((function(n){t.initializing=!1,t.service.getCaseManagers(e.id).subscribe((function(e){t.caseManagers=e.filter((function(t){return t.active})),t.updateList()}))})),t.service.getCaseManagerStats(0,e.id).subscribe((function(e){t.stats=e,t.buildStats()})))})),this.service.getStates().subscribe((function(e){return t.states=e}))},t.prototype.ngOnDestroy=function(){},t.prototype.clearHospitalNum=function(){this.hospitalNum=null,this.filter.hospitalNum=null,this.page=0},t.prototype.search=function(){this.page=0,this.updateList()},t.prototype.assignClients=function(){var t=this;this._dialogService.openConfirm({title:"Confirm",message:"Do you want to assign selected clients to the selected Case Manager?",cancelButton:"No",acceptButton:"Yes",width:"500px"}).afterClosed().subscribe((function(e){if(e){var n=t.patients.filter((function(t){return t.selected})).map((function(t){return t.id}));t.service.assignToCaseManager(t.assignCaseManager.id,n).subscribe((function(e){e.ok?(t.updateList(),t.service.getCaseManagerStats(t.caseManager.id,t.facilityId).subscribe((function(e){t.stats=e,t.buildStats()}))):t.notificationService.showError("Error assigning clients, please try again")}))}}))},t.prototype.deAssignClients=function(){var t=this;this._dialogService.openConfirm({title:"Confirm",message:"Do you want to de-assign selected clients?",cancelButton:"No",acceptButton:"Yes",width:"500px"}).afterClosed().subscribe((function(e){if(e){var n=t.patients.filter((function(t){return t.selected})).map((function(t){return t.id}));t.service.deAssignClients(n).subscribe((function(e){e.ok?(t.updateList(),t.service.getCaseManagerStats(t.caseManager.id,t.facilityId).subscribe((function(e){t.stats=e,t.buildStats()}))):t.notificationService.showError("Error de-assigning clients, please try again")}))}}))},t.prototype.selections=function(){return this.patients&&!!this.patients.find((function(t){return t.selected}))},t.prototype.loadPage=function(t){this.page=t,this.updateList()},t.prototype.select=function(t){this.patients=this.patients.map((function(e){return e.id===t.obj.id&&(e.selected=!e.selected),e}))},t.prototype.caseManagerChanged=function(){var t=this;this.caseManager||(this.stats=null),this.service.getCaseManagerStats(this.caseManager.id,this.facilityId).subscribe((function(e){t.stats=e,t.buildStats()})),this.filterByCaseManager?this.filter.caseManagerId=this.caseManager.id:this.filter.caseManagerId=null,this.updateList()},t.prototype.updateList=function(){var t=this;this.hospitalNum&&(this.filter.hospitalNum=this.hospitalNum),this.filter.facilityId=this.facilityId,this.filter.size=this.itemsPerPage,this.filter.page=this.page>0?this.page-1:0,this.filterByCaseManager?this.filter.caseManagerId=this.caseManager.id:this.filter.caseManagerId=null,this.loading=!0,this.service.getClientList(this.filter).subscribe((function(e){e.body&&(t.patients=e.body.map((function(e){var n=t.caseManagers.find((function(t){return t.id===e.caseManagerId}));return n&&(e.caseManager=n),e})),t.totalItems=e.headers.get("X-Total-Count"),t.service.getCaseManagerStats(0,t.facilityId).subscribe((function(e){t.globalStats=e,t.buildGlobalStats()}))),t.loading=!1}))},t.prototype.ageGroupChanged=function(){9===this.ageLimit?(this.filter.lowerAgeLimit=0,this.filter.upperAgeLimit=9):14===this.ageLimit?(this.filter.lowerAgeLimit=10,this.filter.upperAgeLimit=14):19===this.ageLimit?(this.filter.lowerAgeLimit=15,this.filter.upperAgeLimit=19):24===this.ageLimit?(this.filter.lowerAgeLimit=20,this.filter.upperAgeLimit=24):100===this.ageLimit&&(this.filter.lowerAgeLimit=25,this.filter.upperAgeLimit=100),this.ageLimit||(this.filter.lowerAgeLimit=null,this.filter.upperAgeLimit=null),this.updateList()},t.prototype.pregnancyStatusChanged=function(){1===this.pregnancyStatus?this.filter.pregnant=!0:2===this.pregnancyStatus&&(this.filter.breastfeeding=!0),this.pregnancyStatus||(this.filter.pregnant=null,this.filter.breastfeeding=null),this.updateList()},t.prototype.stateChanged=function(t){var e=this;t&&this.service.getLgasByState(t).subscribe((function(t){return e.lgas=t}))},t.prototype.assigned=function(t){this.filter.assigned=1===t||2!==t&&null,this.updateList()},t.prototype.lgaChanged=function(t){this.filter.lgaId=t||null,this.updateList()},t.prototype.buildStats=function(){this.properties=[],this.properties.push(new o.CardViewIntItemModel({label:"Clients(s) Assigned",key:"as",value:this.stats.assigned})),this.properties.push(new o.CardViewIntItemModel({label:"Stable 1 Year",key:"as",value:this.stats.stable})),this.properties.push(new o.CardViewIntItemModel({label:"Unstable less than 1 Year",key:"as",value:this.stats.unstableLessThan1year})),this.properties.push(new o.CardViewIntItemModel({label:"Unstable more than 1 Year",key:"as",value:this.stats.unstableMoreThan1Year})),this.properties.push(new o.CardViewIntItemModel({label:"Awaiting ART",key:"as",value:this.stats.preArt}))},t.prototype.buildGlobalStats=function(){this.globalProperties=[],this.globalStats&&(this.globalProperties.push(new o.CardViewIntItemModel({label:"Clients(s) Assigned",key:"as",value:this.globalStats.assigned})),this.globalProperties.push(new o.CardViewIntItemModel({label:"Stable 1 Year",key:"as",value:this.globalStats.stable})),this.globalProperties.push(new o.CardViewIntItemModel({label:"Unstable less than 1 Year",key:"as",value:this.globalStats.unstableLessThan1year})),this.globalProperties.push(new o.CardViewIntItemModel({label:"Unstable more than 1 Year",key:"as",value:this.globalStats.unstableMoreThan1Year})),this.globalProperties.push(new o.CardViewIntItemModel({label:"Awaiting ART",key:"as",value:this.globalStats.preArt})))},t.ctorParameters=function(){return[{type:J},{type:c.TdDialogService},{type:o.NotificationService},{type:v.RxStompService}]},t=g([e.Component({selector:"case-management-patient-list",template:'<div class="layout">\n    <div class="list-container">\n        <mat-card>\n            <mat-card-content>\n                <div class="row">\n                    <div class="col-md-6">\n                        <mat-form-field class="full-width">\n                            <mat-label>Facility Case Manager:</mat-label>\n                            <mat-select [(ngModel)]="caseManager" name="caseManager"\n                                        (selectionChange)="caseManagerChanged()">\n                                <mat-option></mat-option>\n                                <mat-option *ngFor="let c of caseManagers" [value]="c">{{c.name}}\n                                </mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                        <div *ngIf="caseManager">\n                            <mat-checkbox [(ngModel)]="filterByCaseManager"\n                                          (change)="updateList()"\n                                          name="activeTb"\n                            >\n                                Filter by Case Manager\n                            </mat-checkbox>\n                        </div>\n                    </div>\n                    <div class="col-md-6">\n                        <div *ngIf="caseManager">\n                            <div class="row">\n                                <div class="col-md-2">\n                                    Clients(s) Assigned:\n                                </div>\n                                <div class="col-md-2">\n                                    {{stats.assigned | number: \'1.\'}}\n                                </div>\n                                <div class="col-md-2">\n                                    Stable 1 Year:\n                                </div>\n                                <div class="col-md-2">\n                                    {{stats.stable | number: \'1.\'}}\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-2">\n                                    Unstable less than 1 Year:\n                                </div>\n                                <div class="col-md-2">\n                                    {{stats.unstableLessThan1year | number: \'1.\'}}\n                                </div>\n                                <div class="col-md-2">\n                                    Unstable more than 1 Year:\n                                </div>\n                                <div class="col-md-2">\n                                    {{stats.unstableMoreThan1Year | number: \'1.\'}}\n                                </div>\n                            </div>\n                            <div class="row">\n                                <div class="col-md-2">\n                                    Awaiting ART:\n                                </div>\n                                <div class="col-md-2">\n                                    {{stats.preArt | number: \'1.\'}}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <h5> Demographic/Clinic filters</h5>\n                <p></p>\n                <div class="row">\n                    <div class="col-md-6">\n                        <mat-form-field class="full-width">\n                            <mat-label>Client Categorization</mat-label>\n                            <mat-select name="categoryId" [(ngModel)]="filter.status" (selectionChange)="updateList()">\n                                <mat-option>--All--</mat-option>\n                                <mat-option value=\'STABLE\'>Stable One Year</mat-option>\n                                <mat-option value=\'UNSTABLE_LESS_THAN_1_YEAR\'>Unstable less than One Year</mat-option>\n                                <mat-option value=\'UNSTABLE_MORE_THAN_1_YEAR\'>Unstable One Year or more</mat-option>\n                                <mat-option value=\'PRE_ART\'>Awaiting ART</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div class="col-md-6">\n                        <mat-form-field class="full-width">\n                            <mat-label>Age Group</mat-label>\n                            <mat-select name="ageGroup" [(ngModel)]="ageLimit" (selectionChange)="ageGroupChanged()">\n                                <mat-option>--All--</mat-option>\n                                <mat-option value=\'9\'>Children (0-9 Years)</mat-option>\n                                <mat-option value=\'14\'>Younger Adolescent (10 to 14 Years)</mat-option>\n                                <mat-option value=\'19\'>Older Adolescent (15 to 19 Years)</mat-option>\n                                <mat-option value=\'24\'>Young People (20 to 24 Years)</mat-option>\n                                <mat-option value=\'100\'>Adults (25 and Above)</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div class="row">\n                    <div class="col-md-6">\n                        <mat-form-field class="full-width">\n                            <mat-label>Gender</mat-label>\n                            <mat-select name="gender" [(ngModel)]="filter.gender" (selectionChange)="updateList()">\n                                <mat-option>--All--</mat-option>\n                                <mat-option [value]="\'FEMALE\'">Female</mat-option>\n                                <mat-option [value]="\'MALE\'">Male</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div class="col-md-6">\n                        <mat-form-field class="full-width">\n                            <mat-label>Pregnancy Status</mat-label>\n                            <mat-select name="pregnancyStatus" [(ngModel)]="pregnancyStatus"\n                                        (selectionChange)="pregnancyStatusChanged()">\n                                <mat-option>--All--</mat-option>\n                                <mat-option value=\'1\'>Pregnant</mat-option>\n                                <mat-option value=\'2\'>Breastfeeding</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div class="row">\n                    <div class="col-md-6">\n                        <mat-form-field class="full-width">\n                            <mat-label>State of Residence</mat-label>\n                            <mat-select name="state" (selectionChange)="stateChanged($event.value.id)">\n                                <mat-option></mat-option>\n                                <mat-option *ngFor="let state of states" [value]="state">{{state.name}}</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div class="col-md-6">\n                        <mat-form-field class="full-width">\n                            <mat-label>LGA of Residence</mat-label>\n                            <mat-select name="lga" (selectionChange)="lgaChanged($event.value.id)">\n                                <mat-option></mat-option>\n                                <mat-option *ngFor="let lga of lgas" [value]="lga">{{lga.name}}</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                </div>\n                <div *ngIf="patients?.length">\n                    <div class="row">\n                        <div class="col-md-2">\n                            Clients(s) Assigned:\n                        </div>\n                        <div class="col-md-2">\n                            {{globalStats.assigned | number: \'1.\'}}\n                        </div>\n                        <div class="col-md-2">\n                            Stable 1 Year:\n                        </div>\n                        <div class="col-md-2">\n                            {{globalStats.stable | number: \'1.\'}}\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-2">\n                            Unstable less than 1 Year:\n                        </div>\n                        <div class="col-md-2">\n                            {{globalStats.unstableLessThan1year | number: \'1.\'}}\n                        </div>\n                        <div class="col-md-2">\n                            Unstable more than 1 Year:\n                        </div>\n                        <div class="col-md-2">\n                            {{globalStats.unstableMoreThan1Year | number: \'1.\'}}\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-2">\n                            Awaiting ART:\n                        </div>\n                        <div class="col-md-2">\n                            {{globalStats.preArt | number: \'1.\'}}\n                        </div>\n                    </div>\n                </div>\n                <div>\n                    <div class="row">\n                        <div class="col-md-8 col-md-offset-4">\n                            <div class="adf-toolbar--spacer"></div>\n                            <td-search-box backIcon="arrow_back" class="push-right-sm"\n                                           placeholder="Search hospital number" [debounce]="500"\n                                           [(ngModel)]="hospitalNum"\n                                           (searchDebounce)="search()"\n                                           (search)="search()"\n                                           (clear)="clearHospitalNum()" flex>\n                            </td-search-box>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Assign to Case Manager:</mat-label>\n                                <mat-select [(ngModel)]="assignCaseManager" name="caseManager1">\n                                    <mat-option></mat-option>\n                                    <mat-option *ngFor="let c of caseManagers" [value]="c">{{c.name}}\n                                    </mat-option>\n                                </mat-select>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-sm-3 col-sm-offset-9">\n                            <div>\n                                <button mat-raised-button color="primary"\n                                        *ngIf="assignCaseManager && selections()"\n                                        (click)="assignClients()">Assign to Case Manager\n                                </button>\n                                <button mat-raised-button color="accent" *ngIf="selections()"\n                                        (click)="deAssignClients()">De-assign Client(s)\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                    <mat-progress-spinner\n                            *ngIf="initializing"\n                            class="adf-document-list-loading-margin"\n                            [color]="\'primary\'"\n                            [mode]="\'indeterminate\'">\n                    </mat-progress-spinner>\n                    <adf-datatable *ngIf="patients || loading"\n                                   [rows]="patients"\n                                   (rowClick)="select($event.value)">\n                        <data-columns>\n                            <data-column key="selected" title="">\n                                <ng-template let-context="$implicit">\n                                    <mat-checkbox [checked]="context.row.getValue(\'selected\')"></mat-checkbox>\n                                </ng-template>\n                            </data-column>\n                            <data-column key="name" title="Name" sortable="true"></data-column>\n                            <data-column key="hospitalNum" title="Hospital Number" sortable="true"></data-column>\n                            <data-column key="gender" title="Gender" sortable="true">\n                                <ng-template let-context="$implicit">\n                                    {{context.row.getValue(\'gender\') === \'MALE\' ? \'Male\' : context.row.getValue(\'gender\') === \'FEMALE\' ? \'Female\' : \'\'}}\n                                </ng-template>\n                            </data-column>\n                            <data-column key="dateBirth" title="Date of Birth" sortable="true">\n                                <ng-template let-context="$implicit">\n                                    {{context.row.getValue(\'dateBirth\') | date: \'dd MMM, yyyy\'}}\n                                </ng-template>\n                            </data-column>\n                            <data-column key="address" title="Address" class="full-width ellipsis-cell"></data-column>\n                            <data-column key="currentStatus" title="ART Status" sortable="true"></data-column>\n                            <data-column key="caseManager.name" title="Assigned to" sortable="true"></data-column>\n                        </data-columns>\n                        <adf-loading-content-template>\n                            <ng-template>\n                                <mat-progress-spinner\n                                        class="adf-document-list-loading-margin"\n                                        [color]="\'primary\'"\n                                        [mode]="\'indeterminate\'">\n                                </mat-progress-spinner>\n                            </ng-template>\n                        </adf-loading-content-template>\n                    </adf-datatable>\n                </div>\n                <adf-empty-content\n                        *ngIf="!patients"\n                        icon="blur_on"\n                        [title]="\'No Patients found\'"\n                        [subtitle]="\'No Patients matching search criteria or no Patients available\'">\n                </adf-empty-content>\n                <div class="row">\n                    <div class="col-md-8">\n                        <ngb-pagination [collectionSize]="totalItems"\n                                        [(page)]="page"\n                                        [pageSize]="itemsPerPage"\n                                        [maxSize]="5"\n                                        size="sm"\n                                        [rotate]="true"\n                                        [boundaryLinks]="true"\n                                        (pageChange)="loadPage(page)">\n                        </ngb-pagination>\n                    </div>\n                    <div class="col-md-4">\n                        <mat-form-field>\n                            <mat-label>Assignment Filter</mat-label>\n                            <mat-select (selectionChange)="assigned($event.value)">\n                                <mat-option></mat-option>\n                                <mat-option [value]="1">Only assigned clients</mat-option>\n                                <mat-option [value]="2">Only clients not assigned</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                </div>\n            </mat-card-content>\n        </mat-card>\n    </div>\n</div>\n'}),M("design:paramtypes",[J,c.TdDialogService,o.NotificationService,v.RxStompService])],t)}(),tt=[{path:"",data:{title:"Case Management",breadcrumb:"CASE MANAGEMENT"},children:[{path:"",children:[{path:"",component:Q,data:{authorities:["ROLE_USER"],title:"Case Management",breadcrumb:"CASE MANAGEMENT"}}],data:{title:"Case Management",breadcrumb:"CASE MANAGEMENT"}}]}],et=function(){function t(){}return t=g([e.NgModule({imports:[V,h.FormsModule,s.CommonModule,l.RouterModule.forChild(tt),o.CoreModule,y.NgbModule,c.CovalentSearchModule,c.CovalentDialogsModule,i.LamisSharedModule],declarations:[Q],providers:[]})],t)}(),nt=function(){function t(t,e){this.http=t,this.serverUrl=e,this.resourceUrl="",this.resourceUrl=e.SERVER_API_URL+"/api/case-managers"}return t.prototype.create=function(t){return this.http.post(this.resourceUrl,t,{observe:"response"})},t.prototype.update=function(t){return this.http.put(this.resourceUrl,t,{observe:"response"})},t.prototype.find=function(t){return this.http.get(this.resourceUrl+"/"+t,{observe:"response"})},t.prototype.findByUuid=function(t){return this.http.get(this.resourceUrl+"/by-uuid/"+t,{observe:"response"})},t.prototype.delete=function(t){return this.http.delete(this.resourceUrl+"/"+t,{observe:"response"})},t.prototype.query=function(t){var e=i.createRequestOption(t);return this.http.get(this.resourceUrl,{params:e,observe:"response"})},t.ctorParameters=function(){return[{type:n.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[i.SERVER_API_URL_CONFIG]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(i.SERVER_API_URL_CONFIG))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"}),b(1,e.Inject(i.SERVER_API_URL_CONFIG)),M("design:paramtypes",[n.HttpClient,Object])],t)}(),it=function(){function t(t,e,n,i,a){this.router=t,this.route=e,this.service=n,this._dialogService=i,this.notificationService=a,this.properties=[]}return t.prototype.ngOnInit=function(){var t=this;this.route.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body:n,t.buildProperties()}))},t.prototype.edit=function(){this.router.navigate(["/","admin","case-managers",this.entity.uuid,"edit"])},t.prototype.delete=function(){var t=this;this._dialogService.openConfirm({title:"Confirm",message:"Do you want to delete this Case Manager, action cannot be reversed?",cancelButton:"No",acceptButton:"Yes",width:"500px"}).afterClosed().subscribe((function(e){e&&t.service.delete(t.entity.id).subscribe((function(e){e.ok?t.router.navigate(["admin","case-managers"]):t.notificationService.showError("Error deleting Case Manager, please try again")}))}))},t.prototype.buildProperties=function(){this.properties.push(new o.CardViewTextItemModel({label:"Name",key:"cs",value:this.entity.name})),this.properties.push(new o.CardViewTextItemModel({label:"Address",key:"fs",value:this.entity.address})),this.properties.push(new o.CardViewTextItemModel({label:"Gender",key:"ts",value:"FEMALE"===this.entity.gender?"Female":"Male"})),this.properties.push(new o.CardViewTextItemModel({label:"Telephone",key:"cd4p",value:this.entity.phoneNumber})),this.properties.push(new o.CardViewBoolItemModel({label:"Active",key:"cd4p",value:this.entity.active}))},t.prototype.previousState=function(){window.history.back()},t.ctorParameters=function(){return[{type:l.Router},{type:l.ActivatedRoute},{type:nt},{type:c.TdDialogService},{type:o.NotificationService}]},t=g([e.Component({selector:"case-manager-details",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <mat-card>\n            <mat-card-header>\n            </mat-card-header>\n            <mat-card-content>\n                <adf-card-view [properties]="properties" editable="false"></adf-card-view>\n            </mat-card-content>\n            <mat-card-actions class="lamis-edit-form-actions">\n                <button mat-button (click)="previousState()">Back</button>\n                <button mat-raised-button color="primary" (click)="edit()">Edit</button>\n            </mat-card-actions>\n        </mat-card>\n    </div>\n</div>\n'}),M("design:paramtypes",[l.Router,l.ActivatedRoute,nt,c.TdDialogService,o.NotificationService])],t)}(),at=function(){function t(t,e,n,i,a){this.caseManagementService=t,this.caseManagerService=e,this.notification=n,this.activatedRoute=i,this.appLoaderService=a}return t.prototype.createEntity=function(){return{}},t.prototype.ngOnInit=function(){var t=this;this.isSaving=!1,this.activatedRoute.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body:n,void 0===t.entity&&(t.entity=t.createEntity()),t.caseManagementService.getActiveFacility().subscribe((function(e){t.entity.facility=e}))}))},t.prototype.save=function(){this.isSaving=!0,this.appLoaderService.open("Saving Case Manager.."),void 0!==this.entity.id?this.subscribeToSaveResponse(this.caseManagerService.update(this.entity)):this.subscribeToSaveResponse(this.caseManagerService.create(this.entity))},t.prototype.previousState=function(){window.history.back()},t.prototype.subscribeToSaveResponse=function(t){var e=this;t.subscribe((function(t){return e.onSaveSuccess(t.body)}),(function(t){e.onSaveError(),e.onError(t.message)}))},t.prototype.onSaveSuccess=function(t){this.appLoaderService.close(),this.isSaving=!1,this.notification.openSnackMessage("Case Manager successfully saved"),this.previousState()},t.prototype.onSaveError=function(){this.isSaving=!1,this.appLoaderService.close(),this.notification.showError("Error occurred saving Case Manager; try again")},t.prototype.onError=function(t){this.appLoaderService.close(),this.notification.showError(t)},t.ctorParameters=function(){return[{type:J},{type:nt},{type:o.NotificationService},{type:l.ActivatedRoute},{type:i.AppLoaderService}]},t=g([e.Component({selector:"case-manager-edit",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <form name="form" role="form" novalidate (ngSubmit)="save()" #caseManagerForm="ngForm">\n            <mat-card class="default">\n                <mat-card-content>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Name</mat-label>\n                                <input matInput name="name" #name="ngModel"\n                                       required\n                                       [(ngModel)]="entity.name"/>\n                                <mat-error\n                                        *ngIf="name.errors && (name.dirty || name.touched) && (name.errors.required)">\n                                    Case Manager name is required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Address</mat-label>\n                                <textarea matInput name="address" [(ngModel)]="entity.address" #address="ngModel"\n                                          rows="2" required>\n                                </textarea>\n                                <mat-error\n                                        *ngIf="address.errors && (address.dirty || address.touched) && (address.errors.required)">\n                                    Case Manager address is required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Sex</mat-label>\n                                <mat-select name="sex" [(ngModel)]="entity.gender" #sex="ngModel" required>\n                                    <mat-option></mat-option>\n                                    <mat-option [value]="\'FEMALE\'">Female</mat-option>\n                                    <mat-option [value]="\'MALE\'">Male</mat-option>\n                                </mat-select>\n                                <mat-error\n                                        *ngIf="sex.errors && (sex.dirty || sex.touched) && (sex.errors.required)">\n                                    Case Manager sex is required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Telephone</mat-label>\n                                <input matInput name="phone" phoneNumber [(ngModel)]="entity.phoneNumber" required\n                                       #phone="ngModel"/>\n                                <mat-error\n                                        *ngIf="phone.errors && (phone.dirty || phone.touched) && (phone.errors.required)">\n                                    Case Manager Telephone number is required\n                                </mat-error>\n                                <mat-error\n                                        *ngIf="phone.errors && (phone.dirty || phone.touched) && (phone.errors.invalidPhone)">\n                                    Invalid phone number\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-checkbox name="active" [(ngModel)]="entity.active">Active</mat-checkbox>\n                        </div>\n                    </div>\n                </mat-card-content>\n                <mat-card-actions class="lamis-edit-form-actions">\n                    <button mat-raised-button type="button" (click)="previousState()">Back</button>\n                    <button mat-raised-button color=\'primary\'\n                            [disabled]="caseManagerForm.invalid || isSaving"\n                            type="submit">\n                        {{entity.id !== undefined ? \'Update\' : \'Save\'}}\n                    </button>\n                </mat-card-actions>\n            </mat-card>\n        </form>\n    </div>\n</div>\n'}),M("design:paramtypes",[J,nt,o.NotificationService,l.ActivatedRoute,i.AppLoaderService])],t)}(),rt=function(){function t(t,e,n,i,a){this.caseManagerService=t,this.caseManagementService=e,this.notification=n,this.router=i,this.activatedRoute=a,this.page=0,this.loading=!1,this.itemsPerPage=200,this.currentSearch="",this.totalItems=0,this.display="list"}return t.prototype.ngOnInit=function(){var t=this;this.caseManagementService.getActiveFacility().subscribe((function(e){t.facility=e,t.onPageChange(0)}))},t.prototype.select=function(t){this.router.navigate(["..","case-managers",t.obj.uuid,"view"],{relativeTo:this.activatedRoute})},t.prototype.onPageChange=function(t){this.page=t,this.loadAll()},t.prototype.loadPage=function(t){this.page=t,this.loadAll()},t.prototype.loadAll=function(){var t=this;this.loading=!0,this.caseManagerService.query({keyword:this.currentSearch,page:0,id:this.facility&&this.facility.id||0,size:this.itemsPerPage,sort:["id","asc"]}).subscribe((function(e){t.onSuccess(e.body,e.headers)}),(function(e){return t.onError(e)}))},t.prototype.onSuccess=function(t,e){this.caseManagers=t,this.totalItems=e.get("X-Total-Count"),this.loading=!1},t.prototype.onError=function(t){this.notification.openSnackMessage(t.message),this.loading=!1},t.ctorParameters=function(){return[{type:nt},{type:J},{type:o.NotificationService},{type:l.Router},{type:l.ActivatedRoute}]},t=g([e.Component({selector:"case-managers",template:'<div class="layout">\n    <div class="list-container">\n        <adf-datatable *ngIf="caseManagers"\n                       [rows]="caseManagers"\n                       [loading]="loading"\n                       [display]="display"\n                       (rowClick)="select($event.value)">\n            <data-columns>\n                <data-column key="name" title="Name" sortable="true"></data-column>\n                <data-column key="gender" title="Gender" sortable="true">\n                    <ng-template let-context="$implicit">\n                        {{context.row.getValue(\'gender\') === \'MALE\' ? \'Male\' : context.row.getValue(\'gender\') === \'FEMALE\' ? \'Female\' : \'\'}}\n                    </ng-template>\n                </data-column>\n                <data-column key="phoneNumber" title="Telephone Number" sortable="true"></data-column>\n                <data-column key="address" title="Address" class="full-width ellipsis-cell"></data-column>\n                <data-column key="active" title="Active" sortable="true">\n                    <ng-template let-context="$implicit">\n                        <mat-checkbox [checked]="context.row.getValue(\'active\')"></mat-checkbox>\n                    </ng-template>\n                </data-column>\n            </data-columns>\n            <adf-loading-content-template>\n                <ng-template>\n                    <mat-progress-spinner\n                            class="adf-document-list-loading-margin"\n                            [color]="\'primary\'"\n                            [mode]="\'indeterminate\'">\n                    </mat-progress-spinner>\n                </ng-template>\n            </adf-loading-content-template>\n        </adf-datatable>\n    </div>\n    <adf-empty-content\n            *ngIf="!caseManagers"\n            icon="blur_on"\n            [title]="\'No Case Managers found\'"\n            [subtitle]="\'No Case Managers matching search criteria or no Case Managers available\'">\n    </adf-empty-content>\n    <ngb-pagination [collectionSize]="totalItems"\n                    [(page)]="page"\n                    [pageSize]="itemsPerPage"\n                    [maxSize]="5"\n                    size="sm"\n                    [rotate]="true"\n                    [boundaryLinks]="true"\n                    (pageChange)="loadPage(page)">\n    </ngb-pagination>\n\n</div>\n<div class="fab-container">\n    <button mat-fab\n            [matTooltip]="\'Add New Case Manager\'"\n            [routerLink]="[\'new\']">\n        <mat-icon>add</mat-icon>\n    </button>\n</div>\n'}),M("design:paramtypes",[nt,J,o.NotificationService,l.Router,l.ActivatedRoute])],t)}(),ot=function(){function t(t){this.service=t}return t.prototype.resolve=function(t,e){var n=t.params.id?t.params.id:null;return n?this.service.findByUuid(n).pipe(a.filter((function(t){return t.ok})),a.map((function(t){return t.body}))):p.of({})},t.ctorParameters=function(){return[{type:nt}]},t=g([e.Injectable(),M("design:paramtypes",[nt])],t)}(),st=[{path:"",data:{title:"Case Manager",breadcrumb:"CASE MANAGERS"},children:[{path:"",component:rt,data:{authorities:["ROLE_USER"],title:"Case Managers",breadcrumb:"CASE MANAGERS"}},{path:":id/view",component:it,resolve:{entity:ot},data:{authorities:["ROLE_USER"],title:"Case Manager",breadcrumb:"CASE MANAGER"}},{path:"new",component:at,data:{authorities:["ROLE_DEC"],title:"Add Case Manager",breadcrumb:"ADD CASE MANAGER"}},{path:":id/edit",component:at,resolve:{entity:ot},data:{authorities:["ROLE_DEC"],title:"Case Manager Edit",breadcrumb:"CASE MANAGER EDIT"}}]}],dt=function(){function t(){}return t=g([e.NgModule({imports:[s.CommonModule,V,o.CoreModule,h.FormsModule,l.RouterModule.forChild(st),o.CoreModule,y.NgbModule,c.CovalentSearchModule,c.CovalentDialogsModule,i.LamisSharedModule],declarations:[it,at,rt],providers:[ot]})],t)}(),lt=r,ct=function(){function t(t,e){this.http=t,this.serverUrl=e,this.resourceUrl="",this.observationResourceUrl="",this.resourceUrl=e.SERVER_API_URL+"/api/cervical-cancer-screenings",this.observationResourceUrl=e.SERVER_API_URL+"/api/observations"}return t.prototype.find=function(t){return this.http.get(this.observationResourceUrl+"/"+t,{observe:"response"}).pipe(a.map((function(t){return console.log("Response1",t),t.body.date=null!=t.body.date?lt(t.body.date):null,t.body.data.dateTreated=null!=t.body.data.dateTreated?lt(t.body.data.dateTreated):null,t.body.data.dateScreened=null!=t.body.data.dateScreened?lt(t.body.data.dateScreened):null,t})))},t.prototype.findByUuid=function(t){return this.find(t)},t.prototype.delete=function(t){return this.http.delete(this.observationResourceUrl+"/"+t,{observe:"response"})},t.prototype.save=function(t){return this.http.post(""+this.observationResourceUrl,t,{observe:"response"}).pipe(a.map((function(t){return t.body.data.dateTreated=null!=t.body.data.dateTreated?lt(t.body.data.dateTreated):null,t.body.data.dateScreened=null!=t.body.data.dateScreened?lt(t.body.data.dateScreened):null,t})))},t.prototype.update=function(t){return this.http.put(""+this.observationResourceUrl,t,{observe:"response"}).pipe(a.map((function(t){return t.body.data.dateTreated=null!=t.body.data.dateTreated?lt(t.body.data.dateTreated):null,t.body.data.dateScreened=null!=t.body.data.dateScreened?lt(t.body.data.dateScreened):null,t})))},t.prototype.getScreeningByPatient=function(t){return this.http.get(this.resourceUrl+"/patient/"+t,{observe:"response"}).pipe(a.map((function(t){return t.body.data=t.body.data.cervicalCancerScreening,t.body.date=null!=t.body.date?lt(t.body.date):null,t.body.data.dateTreated=null!=t.body.data.dateTreated?lt(t.body.data.dateTreated):null,t.body.data.dateScreened=null!=t.body.data.dateScreened?lt(t.body.data.dateScreened):null,t})))},t.ctorParameters=function(){return[{type:n.HttpClient},{type:void 0,decorators:[{type:e.Inject,args:[i.SERVER_API_URL_CONFIG]}]}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(n.HttpClient),e.ɵɵinject(i.SERVER_API_URL_CONFIG))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"}),b(1,e.Inject(i.SERVER_API_URL_CONFIG)),M("design:paramtypes",[n.HttpClient,Object])],t)}(),mt=r,pt=function(){function t(t,e,n,i,a){this.clinicService=t,this.screeningService=e,this.notification=n,this.activatedRoute=i,this.appLoaderService=a,this.entity={},this.observation={},this.today=mt(),this.isSaving=!1}return t.prototype.ngOnInit=function(){var t=this;this.activatedRoute.data.subscribe((function(e){var n=e.entity;t.observation=n&&n.body?n.body:n,t.observation?t.entity=t.observation.data:t.observation={},void 0===t.entity&&(t.entity={});var i=t.activatedRoute.snapshot.paramMap.get("patientId");t.clinicService.getPatient(i).subscribe((function(e){t.patient=e,t.entity&&t.screeningService.getScreeningByPatient(e.id).subscribe((function(e){t.entity=e.body&&e.body.data,t.observation=e.body}))}))}))},t.prototype.previousState=function(){window.history.back()},t.prototype.save=function(){this.isSaving=!0,this.appLoaderService.open("Saving cancer screening..");var t={id:this.observation&&this.observation.id||null,patient:this.patient,date:this.entity.dateScreened.format(i.DATE_FORMAT),facility:this.patient.facility,type:"CERVICAL_CANCER_SCREENING",data:{cervicalCancerScreening:Object.assign({},this.entity,{dateScreened:null!=this.entity.dateScreened&&this.entity.dateScreened.isValid()?this.entity.dateScreened.format(i.DATE_FORMAT):null,dateTreated:null!=this.entity.dateTreated&&this.entity.dateTreated.isValid()?this.entity.dateTreated.format(i.DATE_FORMAT):null})}};this.observation.id?this.subscribeToSaveResponse(this.screeningService.update(t)):this.subscribeToSaveResponse(this.screeningService.save(t))},t.prototype.subscribeToSaveResponse=function(t){var e=this;t.subscribe((function(t){return e.onSaveSuccess(t.body)}),(function(t){e.onSaveError(),e.onError(t.message)}))},t.prototype.onSaveSuccess=function(t){this.appLoaderService.close(),this.isSaving=!1,this.notification.showInfo("Cancer screening successfully saved"),this.previousState()},t.prototype.onSaveError=function(){this.isSaving=!1,this.appLoaderService.close(),this.notification.showError("Error occurred saving cancer screening; try again")},t.prototype.onError=function(t){this.appLoaderService.close(),this.notification.showError(t)},t.ctorParameters=function(){return[{type:w},{type:ct},{type:o.NotificationService},{type:l.ActivatedRoute},{type:i.AppLoaderService}]},t=g([e.Component({selector:"cancer-screening",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <form name="form" role="form" novalidate (ngSubmit)="save()" #screeningForm="ngForm">\n            <mat-card class="default">\n                <mat-card-content *ngIf="patient">\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <input matInput [matDatepicker]="picker"\n                                       placeholder="Date of Screening"\n                                       [(ngModel)]="entity.dateScreened"\n                                       #visit="ngModel"\n                                       [max]="today"\n                                       [min]="patient.dateBirth"\n                                       name="visit"\n                                       required>\n                                <mat-datepicker-toggle\n                                        matSuffix\n                                        [for]="picker">\n                                </mat-datepicker-toggle>\n                                <mat-datepicker #picker></mat-datepicker>\n                                <mat-error\n                                        *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.required)">\n                                    Date of Screening is required\n                                </mat-error>\n                                <mat-error\n                                        *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.min)">\n                                    Date of Screening cannot be before {{patient.dateBirth}}\n                                </mat-error>\n                                <mat-error\n                                        *ngIf="visit.errors && (visit.dirty || visit.touched) && (visit.errors.max)">\n                                    Date of Screening cannot be in the future\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Screening Type</mat-label>\n                                <mat-select name="type" [(ngModel)]="entity.screeningType" #type="ngModel" required>\n                                    <mat-option></mat-option>\n                                    <mat-option [value]="\'FIRST_TIME\'">First Time</mat-option>\n                                    <mat-option [value]="\'FOLLOWUP\'">Followup after previous negative result or\n                                        suspected cancer\n                                    </mat-option>\n                                    <mat-option [value]="\'POST_TREATMENT_FOLLOWUP\'">Post-treatment Followup</mat-option>\n                                </mat-select>\n                                <mat-error\n                                        *ngIf="type.errors && (type.dirty || type.touched) && (type.errors.required)">\n                                    Screening type is required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Screening Method</mat-label>\n                                <mat-select name="method" [(ngModel)]="entity.screeningMethod" #method="ngModel"\n                                            required>\n                                    <mat-option></mat-option>\n                                    <mat-option [value]="\'VIA\'">Visual Inspection with Acetric Acid (VIA)</mat-option>\n                                    <mat-option [value]="\'VILI\'">Visual Inspection with Lugos Iodine (VILI)</mat-option>\n                                    <mat-option [value]="\'PAP_SMEAR\'">PAP Smear</mat-option>\n                                </mat-select>\n                                <mat-error\n                                        *ngIf="method.errors && (method.dirty || method.touched) && (method.errors.required)">\n                                    Screening method is required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Result of Screening</mat-label>\n                                <mat-select name="result" [(ngModel)]="entity.screeningResult" #result="ngModel"\n                                            required>\n                                    <mat-option></mat-option>\n                                    <mat-option [value]="\'NEGATIVE\'">Negative</mat-option>\n                                    <mat-option [value]="\'POSITIVE\'">Positive</mat-option>\n                                    <mat-option [value]="\'SUSPICIOUS\'">Suspicious Cancerous Lesions</mat-option>\n                                </mat-select>\n                                <mat-error\n                                        *ngIf="result.errors && (result.dirty || result.touched) && (result.errors.required)">\n                                    Result of Screening is required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                        <div class="col-md-6" *ngIf="entity.screeningResult === \'POSITIVE\'">\n                            <mat-checkbox [(ngModel)]="entity.referredForTreatment"\n                                          name="uibn"\n                            >\n                                Referred for Treatment?\n                            </mat-checkbox>\n                        </div>\n                    </div>\n                    <div class="row" *ngIf="entity.referredForTreatment">\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width" *ngIf="entity.dateScreened">\n                                <input matInput [matDatepicker]="picker1"\n                                       placeholder="Date Treated"\n                                       [(ngModel)]="entity.dateTreated"\n                                       #treat="ngModel"\n                                       [max]="today"\n                                       [min]="entity.dateScreened"\n                                       name="treat"\n                                       required>\n                                <mat-datepicker-toggle\n                                        matSuffix\n                                        [for]="picker1">\n                                </mat-datepicker-toggle>\n                                <mat-datepicker #picker1></mat-datepicker>\n                                <mat-error\n                                        *ngIf="treat.errors && (treat.dirty || treat.touched) && (treat.errors.required)">\n                                    Date Treated is required\n                                </mat-error>\n                                <mat-error\n                                        *ngIf="treat.errors && (treat.dirty || treat.touched) && (treat.errors.min)">\n                                    Date Treated cannot be before {{entity.dateScreened}}\n                                </mat-error>\n                                <mat-error\n                                        *ngIf="treat.errors && (treat.dirty || treat.touched) && (treat.errors.max)">\n                                    Date Treated cannot be in the future\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                        <div class="col-md-6">\n                            <mat-form-field class="full-width">\n                                <mat-label>Precancerous Lesions Treatment Method</mat-label>\n                                <mat-select name="pc" [(ngModel)]="entity.precancerousLesionsTreatmentMethod"\n                                            #pc="ngModel" required>\n                                    <mat-option></mat-option>\n                                    <mat-option [value]="\'CRYOTHERAPY\'">Cryotherapy</mat-option>\n                                    <mat-option [value]="\'THERMAL_ABLATION\'">Thermal Ablation/ Thermocoagulation\n                                    </mat-option>\n                                    <mat-option [value]="\'LEETZ_LEEP\'">LEETZ/ LEEP</mat-option>\n                                    <mat-option [value]="\'CONIZATION\'">Conization Knifer/ Lagor</mat-option>\n                                </mat-select>\n                                <mat-error\n                                        *ngIf="pc.errors && (pc.dirty || pc.touched) && (pc.errors.required)">\n                                    Treatment method is required\n                                </mat-error>\n                            </mat-form-field>\n                        </div>\n                    </div>\n                </mat-card-content>\n                <mat-card-actions class="lamis-edit-form-actions">\n                    <button mat-raised-button type="button" (click)="previousState()">Back</button>\n                    <button mat-raised-button color=\'primary\'\n                            [disabled]="screeningForm.invalid || isSaving"\n                            type="submit">\n                        {{!!observation ? \'Update\' : \'Save\'}}\n                    </button>\n                </mat-card-actions>\n            </mat-card>\n        </form>\n    </div>\n</div>\n'}),M("design:paramtypes",[w,ct,o.NotificationService,l.ActivatedRoute,i.AppLoaderService])],t)}(),ut={NEGATIVE:"Negative",POSITIVE:"Positive",SUSPICIOUS:"Suspicious Cancerous Lesions"},ht={VIA:"Visual Inspection with Acetric Acid (VIA)",VILI:"Visual Inspection with Lugos Iodine (VILI)",PAP_SMEAR:"PAP Smear"},ft={CRYOTHERAPY:"Cryotherapy",THERMAL_ABLATION:"Thermal Ablation/ Thermocoagulation",LEETZ_LEEP:"LEETZ/ LEEP",CONIZATION:"Conization Knifer/ Lagor"},vt={FIRST_TIME:"First Time",FOLLOWUP:"Followup after previous negative result or suspected cancer",POST_TREATMENT_FOLLOWUP:"Post-treatment Followup"},yt=function(){function t(t,e,n,i,a,r){this.router=t,this.route=e,this.screeningService=n,this._dialogService=i,this.clinicService=a,this.notificationService=r,this.properties=[]}return t.prototype.ngOnInit=function(){var t=this;this.route.data.subscribe((function(e){var n=e.entity;t.entity=n&&n.body?n.body.data.cervicalCancerScreening:n.data.cervicalCancerScreening,t.observation=n&&n.body?n.body:n;var i=t.route.snapshot.paramMap.get("patientId");t.clinicService.getPatient(i).subscribe((function(e){return t.patient=e})),t.buildProperties()}))},t.prototype.edit=function(){this.router.navigate(["/","cervical-cancer-screening",this.observation.id,"patient",this.patient.uuid,"edit"])},t.prototype.delete=function(){var t=this;this._dialogService.openConfirm({title:"Confirm",message:"Do you want to delete this Cervical cancer screening, action cannot be reversed?",cancelButton:"No",acceptButton:"Yes",width:"500px"}).afterClosed().subscribe((function(e){e&&t.screeningService.delete(t.observation.id).subscribe((function(e){e.ok?t.router.navigate(["patients"]):t.notificationService.showError("Error deleting screening, please try again")}))}))},t.prototype.buildProperties=function(){this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.observation.date,label:"Date of Screening",format:"dd MMM, yyyy"})),this.properties.push(new o.CardViewTextItemModel({key:"na",value:vt[this.entity.screeningType],label:"Screening Type"})),this.properties.push(new o.CardViewTextItemModel({label:"Screening Method",key:"fs",value:ht[this.entity.screeningMethod]})),this.properties.push(new o.CardViewTextItemModel({label:"Result",key:"adr",value:ut[this.entity.screeningResult]})),this.properties.push(new o.CardViewBoolItemModel({label:"Referred for Treatment",key:"bw",value:this.entity.referredForTreatment})),this.entity.referredForTreatment&&(this.properties.push(new o.CardViewTextItemModel({label:"Precancerous Lesions Treatment method",key:"adr",value:ft[this.entity.precancerousLesionsTreatmentMethod]})),this.properties.push(new o.CardViewDateItemModel({key:"ds",value:this.entity.dateTreated,label:"Date of Treated",format:"dd MMM, yyyy"})))},t.prototype.previousState=function(){window.history.back()},t.ctorParameters=function(){return[{type:l.Router},{type:l.ActivatedRoute},{type:ct},{type:c.TdDialogService},{type:w},{type:o.NotificationService}]},t=g([e.Component({selector:"cervical-screening-detail",template:'<div class="lamis-edit-form">\n    <div class="lamis-edit-form-container">\n        <mat-card>\n            <mat-card-header>\n            </mat-card-header>\n            <mat-card-content>\n                <adf-card-view [properties]="properties" editable="false"></adf-card-view>\n            </mat-card-content>\n            <mat-card-actions class="lamis-edit-form-actions">\n                <button mat-button (click)="previousState()">Back</button>\n                <button mat-raised-button color="warn" (click)="delete()">Delete</button>\n                <button mat-raised-button color="primary" (click)="edit()">Edit</button>\n            </mat-card-actions>\n        </mat-card>\n    </div>\n</div>\n'}),M("design:paramtypes",[l.Router,l.ActivatedRoute,ct,c.TdDialogService,w,o.NotificationService])],t)}(),gt=function(){function t(t){this.service=t}return t.prototype.resolve=function(t,e){var n=t.params.id?t.params.id:null;return n?this.service.find(n).pipe(a.filter((function(t){return t.ok})),a.map((function(t){return t.body}))):p.of({})},t.ctorParameters=function(){return[{type:ct}]},t.ngInjectableDef=e.ɵɵdefineInjectable({factory:function(){return new t(e.ɵɵinject(ct))},token:t,providedIn:"root"}),t=g([e.Injectable({providedIn:"root"}),M("design:paramtypes",[ct])],t)}(),bt=[{path:"",data:{title:"Cervical Cancer Screening",breadcrumb:"CERVICAL CANCER SCREENING"},children:[{path:":id/patient/:patientId/view",component:yt,resolve:{entity:gt},data:{authorities:["ROLE_USER"],title:"Cervical Cancer Screening",breadcrumb:"CERVICAL CANCER SCREENING"}},{path:"patient/:patientId/new",component:pt,data:{authorities:["ROLE_DEC"],title:"Cervical Cancer Screening",breadcrumb:"ADD CERVICAL CANCER SCREENING"}},{path:":id/patient/:patientId/edit",component:pt,resolve:{entity:gt},data:{authorities:["ROLE_DEC"],title:"Cervical Cancer Screening",breadcrumb:"CERVICAL CANCER SCREENING EDIT"}}]}],Mt=function(){function t(){}return t=g([e.NgModule({imports:[V,h.FormsModule,s.CommonModule,i.MatDateFormatModule,o.CoreModule,l.RouterModule.forChild(bt),c.CovalentMessageModule,c.CovalentDialogsModule,f.CustomFormsModule,i.LamisSharedModule],declarations:[pt,yt],providers:[]})],t)}();t.CaseManagementModule=et,t.CaseManagerModule=dt,t.CervicalCancerModule=Mt,t.ChronicCareModule=H,t.ChronicCareService=F,t.ClinicModule=O,t.ClinicService=w,t.ClinicWidgetModule=P,t.EacModule=X,t.ɵa=E,t.ɵb=x,t.ɵba=bt,t.ɵbb=yt,t.ɵbc=ct,t.ɵbd=pt,t.ɵc=A,t.ɵd=L,t.ɵe=D,t.ɵf=V,t.ɵg=T,t.ɵh=B,t.ɵi=U,t.ɵj=q,t.ɵk=z,t.ɵl=$,t.ɵm=K,t.ɵn=Z,t.ɵo=G,t.ɵp=W,t.ɵq=tt,t.ɵr=Q,t.ɵs=J,t.ɵt=ot,t.ɵu=st,t.ɵv=rt,t.ɵw=nt,t.ɵx=it,t.ɵy=at,t.ɵz=gt,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=lamis-clinic-1.4.0.umd.min.js.map
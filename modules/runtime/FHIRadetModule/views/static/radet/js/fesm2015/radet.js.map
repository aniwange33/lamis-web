{
  "version": 3,
  "file": "radet.js",
  "sources": [
    "ng://radet/lib/services/radet-converter.service.ts",
    "ng://radet/lib/components/radet-converter.component.ts",
    "ng://radet/lib/services/radet.route.ts",
    "ng://radet/lib/radet.module.ts",
    "ng://radet/public_api.ts",
    "ng://radet/radet.ts"
  ],
  "sourcesContent": [
    "import { Inject, Injectable } from \"@angular/core\";\nimport { HttpClient, HttpParams } from \"@angular/common/http\";\nimport { DATE_FORMAT, SERVER_API_URL_CONFIG, ServerApiUrlConfig } from \"@lamis/web-core\";\nimport { Facility } from \"../components/radet-converter.component\";\nimport { Observable } from \"rxjs\";\nimport * as moment_ from 'moment';\n\nconst moment = moment_;\n\n@Injectable()\nexport class RadetConverterService {\n    public resourceUrl = '';\n\n    constructor(private http: HttpClient, @Inject(SERVER_API_URL_CONFIG) private serverUrl: ServerApiUrlConfig) {\n        this.resourceUrl = serverUrl.SERVER_API_URL + '/api/radet';\n    }\n\n    convert(start: Date, end: Date, reportingPeriod: Date, ids: number[]) {\n        let params = new HttpParams();\n        params = params.append('cohortStart', moment(start).format(DATE_FORMAT));\n        params = params.append('cohortEnd', moment(end).format(DATE_FORMAT));\n        params = params.append('reportingPeriod', moment(reportingPeriod).format(DATE_FORMAT));\n        ids.forEach(id => params = params.append(\"ids\", id.toString()));\n        return this.http.get(`${this.resourceUrl}/convert`, {params})\n    }\n\n    listFacilities() {\n        return this.http.get<Facility[]>(`${this.resourceUrl}/list-facilities`)\n    }\n\n    download(name: string): Observable<Blob> {\n        return this.http.get(`${this.resourceUrl}/download/${name}`, {responseType: 'blob'})\n    }\n\n    listFiles() {\n        return this.http.get<string[]>(`${this.resourceUrl}/list-files`)\n    }\n}\n",
    "import { Component, OnDestroy, OnInit } from '@angular/core';\r\nimport { RadetConverterService } from \"../services/radet-converter.service\";\r\nimport { RxStompService } from \"@stomp/ng2-stompjs\";\r\nimport { Message } from '@stomp/stompjs';\r\nimport { Subscription } from \"rxjs\";\r\nimport { DomSanitizer } from \"@angular/platform-browser\";\r\nimport { saveAs } from 'file-saver';\r\nimport { DateRange } from '@syncfusion/ej2-calendars';\r\n\r\nexport interface Facility {\r\n    id: number;\r\n    name: string;\r\n    selected: boolean;\r\n}\r\n\r\n@Component({\r\n    selector: 'radet-converter',\r\n    templateUrl: './radet-convert.component.html'\r\n})\r\nexport class RadetConverterComponent implements OnInit, OnDestroy {\r\n    private topicSubscription: Subscription;\r\n    facilities: Facility[] = [];\r\n    files: string[];\r\n    running = false;\r\n    message: any;\r\n    finished = false;\r\n    dateRange: DateRange = {\r\n        start: new Date(1900, 0, 1),\r\n        end: new Date()\r\n    };\r\n    reportingPeriod: Date = new Date();\r\n    today = new Date();\r\n\r\n    constructor(private service: RadetConverterService, private stompService: RxStompService, private domSanitizer: DomSanitizer) {\r\n    }\r\n\r\n    ngOnInit() {\r\n        this.service.listFacilities().subscribe(res => this.facilities = res);\r\n        this.topicSubscription = this.stompService.watch(\"/topic/radet/status\").subscribe((msg: Message) => {\r\n            if (msg.body === 'start') {\r\n                this.running = true\r\n            } else if (msg.body === 'end') {\r\n                this.running = false;\r\n                this.message = \"Conversion finished; download files from Download tab\";\r\n                this.finished = true;\r\n                this.service.listFiles().subscribe(res => {\r\n                    this.files = res;\r\n                })\r\n            } else {\r\n                this.message = msg.body;\r\n                this.running = true;\r\n            }\r\n        })\r\n    }\r\n\r\n    selected(): boolean {\r\n        return this.facilities.filter(f => f.selected).length > 0\r\n    }\r\n\r\n    download(name: string) {\r\n        this.service.download(name).subscribe(res => {\r\n            const file = new File([res], name + '_Radet.xlsx', {type: 'application/octet-stream'});\r\n            saveAs(file);\r\n        });\r\n    }\r\n\r\n    tabChanged(event) {\r\n        if (event.index === 1) {\r\n            this.service.listFiles().subscribe(res => {\r\n                this.files = res;\r\n            })\r\n        }\r\n    }\r\n\r\n    convert() {\r\n        this.running = true;\r\n        this.finished = false;\r\n        let ids = this.facilities.filter(f => f.selected)\r\n            .map(f => f.id);\r\n        this.service.convert(this.dateRange.start, this.dateRange.end, this.reportingPeriod, ids).subscribe()\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.topicSubscription.unsubscribe()\r\n    }\r\n}\r\n",
    "import { Routes } from '@angular/router';\nimport { RadetConverterComponent } from '../components/radet-converter.component';\n\n\nexport const ROUTES: Routes = [\n    {\n        path: '',\n        data: {\n            title: 'Radet Converter',\n            breadcrumb: 'RADET CONVERTER'\n        },\n        children: [\n            {\n                path: '',\n                component: RadetConverterComponent,\n                data: {\n                    breadcrumb: 'RADET CONVERTER',\n                    title: 'Radet Converter'\n                },\n            }\n        ]\n    }\n];\n\n",
    "import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport {\r\n    MatButtonModule,\r\n    MatCardModule,\r\n    MatCheckboxModule,\r\n    MatDividerModule,\r\n    MatIconModule,\r\n    MatInputModule,\r\n    MatListModule,\r\n    MatProgressBarModule,\r\n    MatSelectModule,\r\n    MatTabsModule\r\n} from '@angular/material';\r\nimport { RouterModule } from '@angular/router';\r\nimport { RadetConverterComponent } from './components/radet-converter.component';\r\nimport { RadetConverterService } from './services/radet-converter.service';\r\nimport { ROUTES } from './services/radet.route';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { DropDownListModule } from '@syncfusion/ej2-angular-dropdowns';\r\nimport { DatePickerModule, DateRangePickerModule } from '@syncfusion/ej2-angular-calendars';\r\n\r\n@NgModule({\r\n    declarations: [\r\n        RadetConverterComponent\r\n    ],\r\n    imports: [\r\n        CommonModule,\r\n        FormsModule,\r\n        MatInputModule,\r\n        MatIconModule,\r\n        MatDividerModule,\r\n        MatCardModule,\r\n        MatSelectModule,\r\n        MatButtonModule,\r\n        MatTabsModule,\r\n        RouterModule.forChild(ROUTES),\r\n        MatProgressBarModule,\r\n        MatListModule,\r\n        MatCheckboxModule,\r\n        DateRangePickerModule,\r\n        DropDownListModule,\r\n        DatePickerModule,\r\n    ],\r\n    exports: [\r\n        RadetConverterComponent\r\n    ],\r\n    providers: [\r\n        RadetConverterService\r\n    ]\r\n})\r\nexport class RadetModule {\r\n}\r\n",
    "/*\r\n * Public API Surface of Patient\r\n */\r\n\r\nexport * from './lib/components/radet-converter.component';\r\nexport * from './lib/services/radet-converter.service';\r\nexport * from './lib/radet.module';\r\nexport * from './lib/services/radet.route';\r\n",
    "/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"
  ],
  "names": [
    "tslib_1.__param"
  ],
  "mappings": "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"
}
